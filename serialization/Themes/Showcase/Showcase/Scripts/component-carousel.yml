---
ID: "ea53e433-4a08-4fa8-b4bb-b3ab598f5672"
Parent: "f96e1925-a3cc-4752-b969-70feb5b5d696"
Template: "962b53c4-f93b-4df9-9821-415c867b8903"
Path: "/sitecore/media library/Themes/Showcase/Showcase/Scripts/component-carousel"
DB: master
SharedFields:
- ID: "06d5295c-ed2f-4a54-9bf2-26228d113318"
  Hint: __Icon
  Value: "-/media/EA53E4334A084FA8B4BBB3AB598F5672.ashx?h=16&thn=1&w=16"
- ID: "40e50ed9-ba07-4702-992e-a912738d32dc"
  Hint: Blob
  BlobID: "121f6dc7-c212-4476-b83d-45dfc0264287"
  Value: LyoqDQogKiBDb2duaWZpZGUNCiAqDQogKiBYQS5jb21wb25lbnQuY2Fyb3VzZWxzIG1vZHVsZS4NCiAqDQogKiBFeHBvc2VzIHJlZ2lzdGVyKHNlbGVjdG9yLCBvcHRpb25zKSBtZXRob2QsIHdoaWNoIGluaXRpYWxpemVzIENhcm91c2VsDQogKiBmb3IgZWFjaCBlbGVtZW50cyB0aGF0IG1hdGNoIHRoZSBwcm92aWRlZCBzZWxlY3Rvciwgd2l0aCBnaXZlbiBvcHRpb25zLg0KICogRWxlbWVudCB1c2VkIGFzIGEgY2Fyb3VzZWwgbXVzdCBjb250YWluIGEgPHVsIGNsYXNzPSJzbGlkZXMiPiB0YWcuDQogKiBUaGF0IHRhZyBoYXZlIHRvIGJlIGZpbGxlZCB3aXRoIDxsaT4gZWxlbWVudHMuIEVhY2ggPGxpPiBlbGVtZW50IHdpbGwgYmUgY29uc2lkZXJlZCBhcyBhIHNsaWRlLg0KICogRm9yIG1vcmUgZGV0YWlscyByZWFkIHRoZSBkb2N1bWVudGF0aW9uIG9mIGEgcmVnaXN0ZXIoc2VsZWN0b3IsIG9wdGlvbnMpIG1ldGhvZC4NCiAqDQogKiBAcmVxdWlyZXMgalF1ZXJ5IEphdmFTY3JpcHQgTGlicmFyeSB2MS40LjQgb3IgaGlnaGVyDQogKi8NClhBLmNvbXBvbmVudC5jYXJvdXNlbHMgPSAoZnVuY3Rpb24oJCkgew0KICAgIHZhciBwdWIgPSB7fSwNCiAgICAgICAgTmF2aWdhdGlvbkJ1aWxkZXIgPSBudWxsLA0KICAgICAgICBTbGlkZXJJbml0aWFsaXplciA9IG51bGw7DQoNCiAgICAvKioNCiAgICAgKiBUaW1lciBjbGFzcyBzYXZlcyB0aW1lIHN0YW1wIGFuZCBjb3VudHMgdGltZSBkaWZmZXJlbmNlIGJldHdlZW4NCiAgICAgKiBjdXJyZW50IHRpbWUgKHVwZGF0ZSgpIG1ldGhvZCkgYW5kIHNhdmVkIHRpbWUgc3RhbXAuDQogICAgICogQGNvbnN0cnVjdG9yDQogICAgICovDQogICAgZnVuY3Rpb24gVGltZXIoKSB7DQogICAgICAgIC8qKg0KICAgICAgICAgKiBUaW1lIGRpZmZlcmVuY2UgYmV0d2VlbiBsYXN0IHVwZGF0ZSgpIGNhbGwgYW5kIGxhc3Qgc2V0KCkgY2FsbA0KICAgICAgICAgKg0KICAgICAgICAgKiBAbWVtYmVyIFRpbWVyDQogICAgICAgICAqLw0KICAgICAgICB0aGlzLmVsYXBzZWQgPSAwOw0KICAgICAgICAvKioNCiAgICAgICAgICogVGltZSBzdGFtcA0KICAgICAgICAgKg0KICAgICAgICAgKiBAbWVtYmVyIFRpbWVyDQogICAgICAgICAqLw0KICAgICAgICB0aGlzLnN0YW1wID0gbnVsbDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiAgQ291bnRzIHRpbWUgZGlmZmVyZW5jZSBiZXR3ZWVuIGN1cnJlbnQgdGltZSBhbmQgc2F2ZWQgdGltZSBzdGFtcA0KICAgICAqDQogICAgICogQG1lbWJlciBUaW1lcg0KICAgICAqLw0KICAgIFRpbWVyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgaWYgKHRoaXMuc3RhbXAgIT09IG51bGwpIHsNCiAgICAgICAgICAgIHRoaXMuZWxhcHNlZCArPSB0aGlzLm5ld1N0YW1wKCkgLSB0aGlzLnN0YW1wOw0KICAgICAgICB9DQogICAgfTsNCg0KICAgIC8qKg0KICAgICAqICBTYXZlcyBuZXcgdGltZSBzdGFtcA0KICAgICAqDQogICAgICogQG1lbWJlciBUaW1lcg0KICAgICAqLw0KICAgIFRpbWVyLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgdGhpcy5zdGFtcCA9IHRoaXMubmV3U3RhbXAoKTsNCiAgICB9Ow0KDQogICAgLyoqDQogICAgICogIENvdW50cyB0aW1lIGRpZmZlcmVuY2UgYmV0d2VlbiBjdXJyZW50IHRpbWUgYW5kIHNhdmVkIHRpbWUgc3RhbXANCiAgICAgKg0KICAgICAqIEBtZW1iZXIgVGltZXINCiAgICAgKiBAcmV0dXJuIHN0YW1wIG9mIGEgY3VycmVudCB0aW1lDQogICAgICogQHR5cGUgTnVtYmVyDQogICAgICovDQogICAgVGltZXIucHJvdG90eXBlLm5ld1N0YW1wID0gZnVuY3Rpb24oKSB7DQogICAgICAgIHJldHVybiBuZXcgRGF0ZSgpLnZhbHVlT2YoKTsNCiAgICB9Ow0KDQogICAgLyoqDQogICAgICogIFJlc2V0cyBlbGFwc2VkIHRpbWUuDQogICAgICoNCiAgICAgKiBAbWVtYmVyIFRpbWVyDQogICAgICovDQogICAgVGltZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKSB7DQogICAgICAgIHRoaXMuZWxhcHNlZCA9IDA7DQogICAgfTsNCiAgICAvKioNCiAgICAgKiBFbmQgb2YgVGltZXIgY2xhc3MNCiAgICAgKi8NCg0KICAgIC8qKg0KICAgICAqIFRpbWVJbmRpY2F0b3IgY2xhc3MgZXh0ZW5kcyBUaW1lciBjbGFzcw0KICAgICAqIEBjb25zdHJ1Y3Rvcg0KICAgICAqIEBwYXJhbSB7T2JqZWN0fSAkICAgICBhIGpRdWVyeSBvYmplY3QNCiAgICAgKiBAcGFyYW0ge1hBLmNvbXBvbmVudC5jYXJvdXNlbHMuSW5kaWNhdG9yVmlld3MuVmlld30gdmlldyAgYSB0aW1lIGluZGljYXRvciB2aWV3Lg0KICAgICAqIEBwYXJhbSB7TnVtYmVyfSB0aW1lb3V0ICAgYSB2aWV3IHRpbWVvdXQNCiAgICAgKiBAYmFzZSBUaW1lcg0KICAgICAqLw0KICAgIGZ1bmN0aW9uIFRpbWVJbmRpY2F0b3IoJCwgdmlldywgdGltZW91dCkgew0KICAgICAgICAvKioNCiAgICAgICAgICogQSB0aW1lIGluZGljYXRvciB2aWV3Lg0KICAgICAgICAgKg0KICAgICAgICAgKiBAbWVtYmVyIFRpbWVySW5kaWNhdG9yDQogICAgICAgICAqLw0KICAgICAgICB0aGlzLnZpZXcgPSB2aWV3Ow0KDQogICAgICAgIHRoaXMudmlldy5pbml0KHRpbWVvdXQpOw0KICAgIH0NCiAgICBUaW1lSW5kaWNhdG9yLnByb3RvdHlwZSA9IG5ldyBUaW1lcigpOw0KICAgIFRpbWVJbmRpY2F0b3IuY29uc3RydWN0b3IgPSBUaW1lcjsNCg0KICAgIC8qKg0KICAgICAqIFBsYXlzIHRoZSBhdHRhY2hlZCB2aWV3Lg0KICAgICAqDQogICAgICogQG1lbWJlciBUaW1lckluZGljYXRvcg0KICAgICAqLw0KICAgIFRpbWVJbmRpY2F0b3IucHJvdG90eXBlLnBsYXkgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgdGhpcy52aWV3LnBsYXkoKTsNCiAgICB9Ow0KDQogICAgLyoqDQogICAgICogUGF1c2VzIHRoZSBhdHRhY2hlZCB2aWV3Lg0KICAgICAqDQogICAgICogQG1lbWJlciBUaW1lckluZGljYXRvcg0KICAgICAqLw0KICAgIFRpbWVJbmRpY2F0b3IucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24oKSB7DQogICAgICAgIHRoaXMudmlldy5wYXVzZSgpOw0KICAgIH07DQoNCiAgICAvKioNCiAgICAgKiBSZXNldHMgZWxhcHNlZCB0aW1lIGFuZCByZXNldHMgdGhlIGF0dGFjaGVkIHZpZXcuDQogICAgICoNCiAgICAgKiBAbWVtYmVyIFRpbWVySW5kaWNhdG9yDQogICAgICovDQogICAgVGltZUluZGljYXRvci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgVGltZXIucHJvdG90eXBlLnJlc2V0LmNhbGwodGhpcyk7DQogICAgICAgIHRoaXMudmlldy5yZXNldCgpOw0KICAgIH07DQoNCiAgICAvKioNCiAgICAgKiBDb3VudHMgdGltZSBkaWZmZXJlbmNlIGJldHdlZW4gY3VycmVudCB0aW1lIGFuZCBzYXZlZCB0aW1lIHN0YW1wLg0KICAgICAqIGFuZCB1cGRhdGVzIHRoZSBhdHRhY2hlZCB2aWV3DQogICAgICoNCiAgICAgKiBAbWVtYmVyIFRpbWVySW5kaWNhdG9yDQogICAgICovDQogICAgVGltZUluZGljYXRvci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7DQogICAgICAgIFRpbWVyLnByb3RvdHlwZS51cGRhdGUuY2FsbCh0aGlzKTsNCiAgICAgICAgdGhpcy52aWV3LnVwZGF0ZSh0aGlzLmVsYXBzZWQpOw0KICAgIH07DQogICAgLyoqDQogICAgICogZW5kIG9mIFRpbWVJbmRpY2F0b3IgY2xhc3MNCiAgICAgKi8NCg0KICAgIC8qKg0KICAgICAqIE5hdmlnYXRpb25CdWlsZGVyIG9iamVjdCBjcmVhdGVzIG5hdmlnYXRpb24gaXRlbXMNCiAgICAgKi8NCiAgICBOYXZpZ2F0aW9uQnVpbGRlciA9IChmdW5jdGlvbigkKSB7DQoNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIGNyZWF0ZUl0ZW0gOiBmdW5jdGlvbihzZXR0aW5ncykgew0KICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gc2V0dGluZ3MudGV4dCwNCiAgICAgICAgICAgICAgICAgICAgJG5hdkl0ZW0gPSBudWxsOw0KDQogICAgICAgICAgICAgICAgc2V0dGluZ3MudGV4dCA9ICcnOw0KICAgICAgICAgICAgICAgIHNldHRpbmdzLmhyZWYgPSAnIyc7DQoNCiAgICAgICAgICAgICAgICAkbmF2SXRlbSA9ICQoJzxhPicsIHNldHRpbmdzKTsNCiAgICAgICAgICAgICAgICAkKCc8c3Bhbj4nLCB7DQogICAgICAgICAgICAgICAgICAgICd0ZXh0JzogdGV4dA0KICAgICAgICAgICAgICAgIH0pLmFwcGVuZFRvKCRuYXZJdGVtKTsNCg0KICAgICAgICAgICAgICAgIHJldHVybiAkbmF2SXRlbTsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAqIFJldHVybnMgdGhlIGVsZW1lbnQocykgdGhhdCBtYXRjaChlcykgdGhlIHByb3ZpZGVkIHNlbGVjdG9yIG9yIG51bGwNCiAgICAgICAgICAgICAqDQogICAgICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gc2VsZWN0b3IgYSBzZWxlY3RvciB1c2VkIGZvciBzZWFyY2hpbmcNCiAgICAgICAgICAgICAqIEByZXR1cm4gYSBqUXVlcnkgb2JqZWN0IGNvbnRhaW5pbmcgZWxlbWVudChzKSB0aGF0IG1hdGNoKGVzKSB0aGUgcHJvdmlkZWQgc2VsZWN0b3Igb3IgbnVsbCBpZiBubyBlbGVtZW50IG1hdGNoDQogICAgICAgICAgICAgKiBAdHlwZSBPYmplY3QNCiAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgZ2V0RWxlbWVudDogZnVuY3Rpb24oc2VsZWN0b3IsIHdyYXBwZXIpIHsNCiAgICAgICAgICAgICAgICB2YXIgJGVsZW1lbnQgPSAkKHdyYXBwZXIpLmZpbmQoIi5uYXYtaXRlbXMiKTsNCg0KICAgICAgICAgICAgICAgIGlmICgkZWxlbWVudC5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgJGVsZW1lbnQgPSBudWxsOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHJldHVybiAkZWxlbWVudDsNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAqIENyZWF0ZXMgbmF2aWdhdGlvbiBpdGVtcyBhbmQgYXBwZW5kcyB0aGVtIHRvICRjb250YWluZXIuDQogICAgICAgICAgICAgKg0KICAgICAgICAgICAgICogQHBhcmFtIHtPYmplY3R9ICRjb250YWluZXIgICBuYXZpZ2F0aW9uIGl0ZW1zIGNvbnRhaW5lciAoalF1ZXJ5IG9iamVjdCkNCiAgICAgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBsYWJlbCAgIG5hdmlnYXRpb24gaXRlbXMgbGFiZWwgdGVtcGxhdGUNCiAgICAgICAgICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb3VudCAgICBudW1iZXIgb2YgbmF2aWdhdGlvbiBpdGVtcyB0byBjcmVhdGUNCiAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgY3JlYXRlSXRlbXM6IGZ1bmN0aW9uKCRjb250YWluZXIsIGxhYmVsLCBjb3VudCkgew0KICAgICAgICAgICAgICAgIHZhciBpLA0KICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuID0gLyNce2luZGV4XH0vZywNCiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3M7DQoNCiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQ7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICBzZXR0aW5ncyA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICd0ZXh0JzogbGFiZWwucmVwbGFjZShwYXR0ZXJuLCBpICsgMSkNCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3MudGV4dCA9ICcnOw0KICAgICAgICAgICAgICAgICAgICBzZXR0aW5ncy5ocmVmID0gJyMnOw0KDQoNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVJdGVtKHNldHRpbmdzKS5hcHBlbmRUbygkY29udGFpbmVyKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgLyoqDQogICAgICAgICAgICAgKiBDcmVhdGVzIG9yIHNlbGVjdHMgJ3ByZXZpb3VzJy8nbmV4dCcgbmF2aWdhdGlvbiBpdGVtLg0KICAgICAgICAgICAgICogTW9kZSBvZiBhY3Rpb24gZGVwZW5kcyBvbiBzZXR0aW5ncyBvYmplY3Q6DQogICAgICAgICAgICAgKiB2YXIgc2V0dGluZ3MgPSB7DQogICAgICAgICAgICAgKiAgICAgaXNDb250YWluZXI6IEJvb2xlYW4gdmFsdWUsDQogICAgICAgICAgICAgKiAgICAgbGFiZWw6IFN0cmluZyB2YWx1ZSwNCiAgICAgICAgICAgICAqICAgICBzZWxlY3RvcjogU3RyaW5nIHZhbHVlLA0KICAgICAgICAgICAgICogICAgIG1ldGhvZDogU3RyaW5nIHZhbHVlDQogICAgICAgICAgICAgKiB9Ow0KICAgICAgICAgICAgICoNCiAgICAgICAgICAgICAqIElmIHNldHRpbmdzLnNlbGVjdG9yID09PSBudWxsIG9yIGlmIHNldHRpbmdzLnNlbGVjdG9yICE9PSBudWxsIGFuZCBzZXR0aW5ncy5pc0NvbnRhaW5lciA9PSB0cnVlDQogICAgICAgICAgICAgKiBuYXZpZ2F0aW9uIGl0ZW0gaXMgY3JlYXRlZCBhbmQgYXR0YWNoZWQgdG8gJGVsZW1lbnQuZmlyc3QoKSAodXNpbmcgc2V0dGluZ3MubWV0aG9kKS4NCiAgICAgICAgICAgICAqIElmIHNldHRpbmdzLnNlbGVjdG9yICE9PSBudWxsIGFuZCBzZXR0aW5ncy5pc0NvbnRhaW5lciA9PSBmYWxzZQ0KICAgICAgICAgICAgICogJGVsZW1lbnQuZmlyc3QoKSBpcyBzZWxlY3RlZCBhcyBuYXZpZ2F0aW9uIGl0ZW0NCiAgICAgICAgICAgICAqDQogICAgICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gc2V0dGluZ3Mgc2V0dGluZ3Mgb2YgbmF2aWdhdGlvbiBpdGVtDQogICAgICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gaXRlbVNldHRpbmdzICAgaHRtbCBhdHRyaWJ1dGVzIG9mIG5hdmlnYXRpb24gaXRlbQ0KICAgICAgICAgICAgICogQHBhcmFtIHtPYmplY3R9ICRlbGVtZW50ICAgIG5hdmlnYXRpb24gaXRlbXMgY29udGFpbmVyIChqUXVlcnkgb2JqZWN0KQ0KICAgICAgICAgICAgICogQHJldHVybiBUaGUgJ3ByZXYnLyduZXh0JyBuYXZpZ2F0aW9uIGl0ZW0NCiAgICAgICAgICAgICAqIEB0eXBlIE9iamVjdA0KICAgICAgICAgICAgICovDQogICAgICAgICAgICBjcmVhdGVQcmV2TmV4dEl0ZW06IGZ1bmN0aW9uKHNldHRpbmdzLCBpdGVtU2V0dGluZ3MsICRlbGVtZW50KSB7DQogICAgICAgICAgICAgICAgdmFyICRpdGVtID0gbnVsbCwNCiAgICAgICAgICAgICAgICAgICAgaXNTZWxlY3RvckV4aXN0cyA9IHNldHRpbmdzLnNlbGVjdG9yICE9PSBudWxsOw0KDQoNCiAgICAgICAgICAgICAgICBpZiAoaXNTZWxlY3RvckV4aXN0cykgew0KICAgICAgICAgICAgICAgICAgICAkZWxlbWVudCA9IHRoaXMuZ2V0RWxlbWVudChzZXR0aW5ncy5zZWxlY3Rvcik7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKCRlbGVtZW50ICE9PSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChzZXR0aW5ncy5pc0NvbnRhaW5lciB8fCAhaXNTZWxlY3RvckV4aXN0cykgew0KICAgICAgICAgICAgICAgICAgICAgICAgJGl0ZW0gPSB0aGlzLmNyZWF0ZUl0ZW0oJC5leHRlbmQoe30sIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndGV4dCc6IHNldHRpbmdzLmxhYmVsDQogICAgICAgICAgICAgICAgICAgICAgICB9LCBpdGVtU2V0dGluZ3MpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICgkZWxlbWVudC5maXJzdCgpKVtzZXR0aW5ncy5tZXRob2RdKCRpdGVtKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICRpdGVtID0gJGVsZW1lbnQuZmlyc3QoKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHJldHVybiAkaXRlbTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfTsNCiAgICB9KCQpKTsNCiAgICAvKioNCiAgICAgKiBlbmQgb2YgTmF2aWdhdGlvbkJ1aWxkZXIgb2JqZWN0DQogICAgICovDQoNCiAgICAvKioNCiAgICAgKiBOYXZpZ2F0aW9uIGNsYXNzIGhvbGRzIG5hdmlnYXRpb24gaXRlbXMuDQogICAgICogQGNvbnN0cnVjdG9yDQogICAgICovDQogICAgZnVuY3Rpb24gTmF2aWdhdGlvbigkLCAkd3JhcHBlciwgb3B0aW9ucykgew0KICAgICAgICB2YXIgZGVmYXVsdHMgPSB7DQogICAgICAgICAgICAgICAgJ2lzRW5hYmxlZCc6IHRydWUsDQogICAgICAgICAgICAgICAgJ2hhc1ByZXZOZXh0SXRlbXMnOiB0cnVlLA0KICAgICAgICAgICAgICAgICdpdGVtJzogew0KICAgICAgICAgICAgICAgICAgICAnbGFiZWwnOiAnI3tpbmRleH0nLA0KICAgICAgICAgICAgICAgICAgICAnc2VsZWN0b3InOiBudWxsDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAncHJldkl0ZW0nOiB7DQogICAgICAgICAgICAgICAgICAgICdsYWJlbCc6ICc8JywNCiAgICAgICAgICAgICAgICAgICAgJ3NlbGVjdG9yJzogbnVsbCwNCiAgICAgICAgICAgICAgICAgICAgJ2lzQ29udGFpbmVyJzogZmFsc2UNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICduZXh0SXRlbSc6IHsNCiAgICAgICAgICAgICAgICAgICAgJ2xhYmVsJzogJz4nLA0KICAgICAgICAgICAgICAgICAgICAnc2VsZWN0b3InOiBudWxsLA0KICAgICAgICAgICAgICAgICAgICAnaXNDb250YWluZXInOiBmYWxzZQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgJ3NsaWRlc0NvdW50JzogMA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHNldHRpbmdzID0gJC5leHRlbmQodHJ1ZSwge30sIGRlZmF1bHRzLCBvcHRpb25zKSwNCiAgICAgICAgICAgICRjb250YWluZXI7DQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIGpRdWVyeSBvYmplY3QNCiAgICAgICAgICoNCiAgICAgICAgICogQG1lbWJlciBOYXZpZ2F0aW9uDQogICAgICAgICAqLw0KICAgICAgICB0aGlzLiQgPSAkOw0KICAgICAgICAvKioNCiAgICAgICAgICogTmF2aWdhdGlvbiBpdGVtcyAob25lIGZvciBlYWNoIHNsaWRlIGlmIG5hdmlnYXRpb24gaXMgZW5hYmxlZCkuDQogICAgICAgICAqDQogICAgICAgICAqIEBtZW1iZXIgTmF2aWdhdGlvbg0KICAgICAgICAgKi8NCiAgICAgICAgdGhpcy4kaXRlbXMgPSAkKCk7DQogICAgICAgIC8qKg0KICAgICAgICAgKiBOYXZpZ2F0aW9uICduZXh0JyBpdGVtIChpZiBwcmV2L25leHQgaXRlbXMgYXJlIGVuYWJsZWQpLg0KICAgICAgICAgKg0KICAgICAgICAgKiBAbWVtYmVyIE5hdmlnYXRpb24NCiAgICAgICAgICovDQogICAgICAgIHRoaXMuJG5leHRJdGVtID0gJCgpOw0KICAgICAgICAvKioNCiAgICAgICAgICogTmF2aWdhdGlvbiAncHJldmlvdXMnIGl0ZW0gKGlmIHByZXYvbmV4dCBpdGVtcyBhcmUgZW5hYmxlZCkuDQogICAgICAgICAqDQogICAgICAgICAqIEBtZW1iZXIgTmF2aWdhdGlvbg0KICAgICAgICAgKi8NCiAgICAgICAgdGhpcy4kcHJldkl0ZW0gPSAkKCk7DQogICAgICAgIC8qKg0KICAgICAgICAgKiBTZWxlY3RlZCBpdGVtIChvbmUgZnJvbSB0aGlzLiRpdGVtcyBvciBudWxsKS4NCiAgICAgICAgICoNCiAgICAgICAgICogQG1lbWJlciBOYXZpZ2F0aW9uDQogICAgICAgICAqLw0KICAgICAgICB0aGlzLiRzZWxlY3RlZEl0ZW0gPSBudWxsOw0KDQogICAgICAgIC8vaW5pdGlhbGl6YXRpb24NCiAgICAgICAgaWYgKHNldHRpbmdzLmlzRW5hYmxlZCkgew0KICAgICAgICAgICAgJGNvbnRhaW5lciA9IHRoaXMucHJlcGFyZUl0ZW1zKHNldHRpbmdzLml0ZW0sIHNldHRpbmdzLnNsaWRlc0NvdW50LCAkd3JhcHBlcik7DQogICAgICAgICAgICBpZiAoc2V0dGluZ3MuaGFzUHJldk5leHRJdGVtcykgew0KICAgICAgICAgICAgICAgIHRoaXMucHJlcGFyZVByZXZOZXh0SXRlbXMoc2V0dGluZ3MsICRjb250YWluZXIpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAkd3JhcHBlci5maW5kKCcubmF2JykudHJpZ2dlcignbmF2aWdhdGlvbi1jcmVhdGVkJywgdGhpcyk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBDU1MgY2xhc3NtIHdoaWNoIHdpbGwgYmUgdXNlZCBmb3IgbWFyayBzZWxlY3RlZCBpdGVtDQogICAgICoNCiAgICAgKiBAbWVtYmVyIE5hdmlnYXRpb24NCiAgICAgKi8NCiAgICBOYXZpZ2F0aW9uLnByb3RvdHlwZS5zZWxlY3RlZEl0ZW1DbGFzcyA9ICdhY3RpdmUnOw0KDQogICAgLyoqDQogICAgICogTWFyayBuYXZpZ2F0aW9uIGl0ZW0gd2l0aCBnaXZlbiBpbmRleCBhcyBzZWxlY3RlZC4NCiAgICAgKg0KICAgICAqIEBtZW1iZXIgTmF2aWdhdGlvbg0KICAgICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleCAgICAgaW5kZXggb2YgbmF2aWdhdGlvbiBpdGVtDQogICAgICovDQogICAgTmF2aWdhdGlvbi5wcm90b3R5cGUuc2VsZWN0SXRlbSA9IGZ1bmN0aW9uKGluZGV4KSB7DQogICAgICAgIGlmICh0aGlzLiRzZWxlY3RlZEl0ZW0gIT09IG51bGwpIHsNCiAgICAgICAgICAgIHRoaXMuJHNlbGVjdGVkSXRlbS5yZW1vdmVDbGFzcyh0aGlzLnNlbGVjdGVkSXRlbUNsYXNzKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHRoaXMuJHNlbGVjdGVkSXRlbSA9IHRoaXMuJGl0ZW1zLmVxKGluZGV4KS5hZGRDbGFzcyh0aGlzLnNlbGVjdGVkSXRlbUNsYXNzKTsNCiAgICB9Ow0KDQogICAgLyoqDQogICAgICogQ3JlYXRlcyBvciBzZWxlY3RzIG5hdmlnYXRpb24gaXRlbXMgY29udGFpbmVyIGFuZCBmaWxscyBpdCB3aXRoIG5hdmlnYXRpb24gaXRlbXMuDQogICAgICogSWYgbmF2aWdhdGlvbiBpdGVtcyBjb250YWluZXIgaXMgbm90IGVtcHR5LCBjaGlsZCBlbGVtZW50cyBhcmUgYWRvcHRlZCBhcyBuYXZpZ2F0aW9uIGl0ZW1zLg0KICAgICAqIE1vZGUgb2YgYWN0aW9uIGRlcGVuZHMgb24gc2V0dGluZ3Mgb2JqZWN0Og0KICAgICAqIHZhciBzZXR0aW5ncyA9IHsNCiAgICAgKiAgICAgJ2xhYmVsJzogJyN7aW5kZXh9JywNCiAgICAgKiAgICAgJ3NlbGVjdG9yJzogbnVsbA0KICAgICAqIH07DQogICAgICogSWYgc2V0dGluZ3Muc2VsZWN0b3IgPT09IG51bGwgbmF2aWdhdGlvbiBpdGVtIGNvbnRhaW5lciBpcyBjcmVhdGVkLg0KICAgICAqIElmIHNldHRpbmdzLnNlbGVjdG9yICE9PSBudWxsIGVsZW1lbnQgdGhhdCBtYXRjaCBzZXR0aW5ncy5zZWxlY3RvciBpcyBhZGFwdGVkIGFzIG5hdmlnYWdhdGlvbiBpdGVtcyBjb250YWluZXIuDQogICAgICoNCiAgICAgKiBAbWVtYmVyIE5hdmlnYXRpb24NCiAgICAgKiBAcGFyYW0ge09iamVjdH0gc2V0dGluZ3Mgc2V0dGluZ3Mgb2YgbmF2aWdhdGlvbiBpdGVtcw0KICAgICAqIEBwYXJhbSB7TnVtYmVyfSBjb3VudCAgIG51bWJlciBvZiBuYXZpZ2F0aW9uIGl0ZW1zDQogICAgICogQHBhcmFtIHtPYmplY3R9ICR3cmFwcGVyICAgIHdyYXBwZXIgb2YgbmF2aWdhdGlvbiBpdGVtcyBjb250YWluZXIgKGpRdWVyeSBvYmplY3QpDQogICAgICogQHJldHVybiBUaGUgY29udGFpbmVyIGZpbGxlZCB3aXRoIG5hdmlnYXRpb24gaXRlbXMuDQogICAgICogQHR5cGUgT2JqZWN0DQogICAgICovDQogICAgTmF2aWdhdGlvbi5wcm90b3R5cGUucHJlcGFyZUl0ZW1zID0gZnVuY3Rpb24oc2V0dGluZ3MsIGNvdW50LCAkd3JhcHBlcikgew0KICAgICAgICB2YXIgJGNvbnRhaW5lciA9IG51bGw7DQoNCiAgICAgICAgaWYgKHNldHRpbmdzLnNlbGVjdG9yICE9PSBudWxsKSB7DQogICAgICAgICAgICAkY29udGFpbmVyID0gTmF2aWdhdGlvbkJ1aWxkZXIuZ2V0RWxlbWVudChzZXR0aW5ncy5zZWxlY3RvciwgJHdyYXBwZXIpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgJGNvbnRhaW5lciA9ICQoJzxkaXYvPicsIHsNCiAgICAgICAgICAgICAgICAnY2xhc3MnOiAnbmF2Jw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAkY29udGFpbmVyLmFwcGVuZFRvKCR3cmFwcGVyKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICgkY29udGFpbmVyICE9PSBudWxsKSB7DQogICAgICAgICAgICBpZiAoJGNvbnRhaW5lci5jaGlsZHJlbigpLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgIE5hdmlnYXRpb25CdWlsZGVyLmNyZWF0ZUl0ZW1zKCRjb250YWluZXIsIHNldHRpbmdzLmxhYmVsLCBjb3VudCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLiRpdGVtcyA9ICRjb250YWluZXIuY2hpbGRyZW4oKS5zbGljZSgwLCBjb3VudCk7DQogICAgICAgIH0NCg0KICAgICAgICByZXR1cm4gJGNvbnRhaW5lcjsNCiAgICB9Ow0KDQogICAgLyoqDQogICAgICogQ3JlYXRlcyBvciBzZWxlY3RzIG5hdmlnYXRpb24gJ3ByZXZpb3VzJyBhbmQgJ25leHQnIG5hdmlnYXRpb24gaXRlbXMgKEBzZWUgTmF2aWdhdGlvbkJ1aWxkZXIuY3JlYXRlUHJldk5leHRJdGVtKCkpLg0KICAgICAqIElmIG5hdmlnYXRpb24gaXRlbXMgY29udGFpbmVyIGlzIG5vdCBlbXB0eSwgY2hpbGQgZWxlbWVudHMgYXJlIGFkb3B0ZWQgYXMgbmF2aWdhdGlvbiBpdGVtcy4NCiAgICAgKg0KICAgICAqIEBtZW1iZXIgTmF2aWdhdGlvbg0KICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzZXR0aW5ncyBzZXR0aW5ncyBvZiBuYXZpZ2F0aW9uDQogICAgICogQHBhcmFtIHtPYmplY3R9ICRjb250YWluZXIgICAgbmF2aWdhdGlvbiBpdGVtcyBjb250YWluZXIgKGpRdWVyeSBvYmplY3QpDQogICAgICovDQogICAgTmF2aWdhdGlvbi5wcm90b3R5cGUucHJlcGFyZVByZXZOZXh0SXRlbXMgPSBmdW5jdGlvbihzZXR0aW5ncywgJGNvbnRhaW5lcikgew0KICAgICAgICB2YXIgJGl0ZW07DQoNCiAgICAgICAgc2V0dGluZ3MucHJldkl0ZW0ubWV0aG9kID0gJ3ByZXBlbmQnOw0KICAgICAgICAkaXRlbSA9IE5hdmlnYXRpb25CdWlsZGVyLmNyZWF0ZVByZXZOZXh0SXRlbShzZXR0aW5ncy5wcmV2SXRlbSwgew0KICAgICAgICAgICAgJ2NsYXNzJzogJ3ByZXYnDQogICAgICAgIH0sICRjb250YWluZXIpOw0KICAgICAgICB0aGlzLiRwcmV2SXRlbSA9ICgkaXRlbSA9PT0gbnVsbCkgPyB0aGlzLiRwcmV2SXRlbSA6ICRpdGVtOw0KDQogICAgICAgIHNldHRpbmdzLm5leHRJdGVtLm1ldGhvZCA9ICdhcHBlbmQnOw0KICAgICAgICAkaXRlbSA9IE5hdmlnYXRpb25CdWlsZGVyLmNyZWF0ZVByZXZOZXh0SXRlbShzZXR0aW5ncy5uZXh0SXRlbSwgew0KICAgICAgICAgICAgJ2NsYXNzJzogJ25leHQnDQogICAgICAgIH0sICRjb250YWluZXIpOw0KICAgICAgICB0aGlzLiRuZXh0SXRlbSA9ICgkaXRlbSA9PT0gbnVsbCkgPyB0aGlzLiRuZXh0SXRlbSA6ICRpdGVtOw0KICAgIH07DQogICAgLyoqDQogICAgICogZW5kIG9mIE5hdmlnYXRpb24gY2xhc3MNCiAgICAgKi8NCg0KICAgIC8qKg0KICAgICAqIFNsaWRlckNvbnRleHQgY2xhc3MgaXMgYmluZGVkIHRvIGEgU2xpZGVyIGNsYXNzIGluc3RhbmNlDQogICAgICogYW5kIGhvbGRzIGl0cyBwcm9wZXJ0aWVzLg0KICAgICAqIEBjb25zdHJ1Y3Rvcg0KICAgICAqLw0KICAgIGZ1bmN0aW9uIFNsaWRlckNvbnRleHQoKSB7DQogICAgICAgIC8qKg0KICAgICAgICAgKiBGbGFnLCB3aGljaCBkZXRlcm1pbmVzIGlmIHNsaWRlIGNhbiBvciBjYW4gbm90IGJlIGNoYW5nZWQgKGZvciB1c2VyIHJlcXVlc3QpDQogICAgICAgICAqDQogICAgICAgICAqIEBtZW1iZXIgU2xpZGVyQ29udGV4dA0KICAgICAgICAgKi8NCiAgICAgICAgdGhpcy5jYW5DaGFuZ2VTbGlkZSA9IHRydWU7DQogICAgICAgIC8qKg0KICAgICAgICAgKiBEZWZhdWx0IFNsaWRlciBzZXR0aW5nIG9iamVjdCAoQHNlZSBTbGlkZXIpDQogICAgICAgICAqDQogICAgICAgICAqIEBtZW1iZXIgU2xpZGVyQ29udGV4dA0KICAgICAgICAgKi8NCiAgICAgICAgdGhpcy5kZWZhdWx0cyA9IG51bGw7DQogICAgICAgIC8qKg0KICAgICAgICAgKiBOYXZpZ2F0aW9uIG9iamVjdCAoQHNlZSBOYXZpZ2F0aW9uKQ0KICAgICAgICAgKg0KICAgICAgICAgKiBAbWVtYmVyIFNsaWRlckNvbnRleHQNCiAgICAgICAgICovDQogICAgICAgIHRoaXMubmF2aWdhdGlvbiA9IG51bGw7DQogICAgICAgIC8qKg0KICAgICAgICAgKiBTbGlkZXIgb2JqZWN0LCB3aGljaCB0aGlzIGNvbnRleHQgaXMgYXR0YWNlaGQgdG8uDQogICAgICAgICAqDQogICAgICAgICAqIEBtZW1iZXIgU2xpZGVyQ29udGV4dA0KICAgICAgICAgKi8NCiAgICAgICAgdGhpcy5vd25lciA9IG51bGw7DQogICAgICAgIC8qKg0KICAgICAgICAgKiBGbGFnLCB3aGljaCBkZXRlcm1pbmVzIGlmIGNoYW5nZSBvZiBhIHNsaWRlIGNhbiBvciBjYW4gbm90IGJlIHNjaGVkdWxlZA0KICAgICAgICAgKg0KICAgICAgICAgKiBAbWVtYmVyIFNsaWRlckNvbnRleHQNCiAgICAgICAgICovDQogICAgICAgIHRoaXMucHJldmVudFNjaGVkdWxpbmcgPSBmYWxzZTsNCiAgICAgICAgLyoqDQogICAgICAgICAqIFNsaWRlciBzZXR0aW5nIG9iamVjdA0KICAgICAgICAgKg0KICAgICAgICAgKiBAbWVtYmVyIFNsaWRlckNvbnRleHQNCiAgICAgICAgICovDQogICAgICAgIHRoaXMuc2V0dGluZ3MgPSBudWxsOw0KICAgICAgICAvKioNCiAgICAgICAgICogSW5zdGFuY2Ugb2YgVGltZXIgY2xhc3MgKEBzZWUgVGltZXIpLCB3aGljaCBpcyB1c2VkIHRvIHN0b3JlIGhvdyBtdWNoDQogICAgICAgICAqIHRpbWUgaXMgbGVmdCB0byBjaGFuZ2UgdGhlIHNsaWRlDQogICAgICAgICAqDQogICAgICAgICAqIEBtZW1iZXIgU2xpZGVyQ29udGV4dA0KICAgICAgICAgKi8NCiAgICAgICAgdGhpcy5zbGlkZVRpbWVyID0gbmV3IFRpbWVyKCk7DQogICAgICAgIC8qKg0KICAgICAgICAgKiBJbnN0YW5jZSBvZiBUaW1lSW5kaWNhdG9yIGNsYXNzIChAc2VlIFRpbWVJbmRpY2F0b3IpDQogICAgICAgICAqDQogICAgICAgICAqIEBtZW1iZXIgU2xpZGVyQ29udGV4dA0KICAgICAgICAgKi8NCiAgICAgICAgdGhpcy50aW1lSW5kaWNhdG9yID0gbnVsbDsNCiAgICAgICAgLyoqDQogICAgICAgICAqIFRpbWVycyBhcnJheS4NCiAgICAgICAgICoNCiAgICAgICAgICogQG1lbWJlciBTbGlkZXJDb250ZXh0DQogICAgICAgICAqLw0KICAgICAgICB0aGlzLnRpbWVycyA9IFtdOw0KICAgICAgICAvKioNCiAgICAgICAgICogTGFzdCB0aW1lb3V0IGlkZW50aWZpZXIuDQogICAgICAgICAqDQogICAgICAgICAqIEBtZW1iZXIgU2xpZGVyQ29udGV4dA0KICAgICAgICAgKi8NCiAgICAgICAgdGhpcy50aW1lb3V0SWQgPSBudWxsOw0KICAgICAgICAvKioNCiAgICAgICAgICogVHJhbnNpdGlvbiAoQHNlZSBYQS5jb21wb25lbnQuY2Fyb3VzZWxzLlRyYW5zaXRpb25zLlRyYW5zaXRpb24pIHVzZWQgd2hpbGUgY2hhbmdpbmcgc2xpZGVzDQogICAgICAgICAqDQogICAgICAgICAqIEBtZW1iZXIgU2xpZGVyQ29udGV4dA0KICAgICAgICAgKi8NCiAgICAgICAgdGhpcy50cmFuc2l0aW9uID0gbnVsbDsNCiAgICAgICAgLyoqDQogICAgICAgICAqIFRyYW5zaXRpb24gc2V0dGluZ3Mgb2JqZWN0IChAc2VlIFhBLmNvbXBvbmVudC5jYXJvdXNlbHMuVHJhbnNpdGlvbnMuVHJhbnNpdGlvblNldHRpbmdzKQ0KICAgICAgICAgKg0KICAgICAgICAgKiBAbWVtYmVyIFNsaWRlckNvbnRleHQNCiAgICAgICAgICovDQogICAgICAgIHRoaXMudHJhbnNpdGlvblNldHRpbmdzID0gbmV3IFhBLmNvbXBvbmVudC5jYXJvdXNlbHMuVHJhbnNpdGlvbnMuVHJhbnNpdGlvblNldHRpbmdzKCk7DQogICAgICAgIC8qKg0KICAgICAgICAgKiBqUXVlcnkgb2JqZWN0IHdoaWNoIGNvbnRhaW5zIGFsbCBzbGlkZXMNCiAgICAgICAgICoNCiAgICAgICAgICogQG1lbWJlciBTbGlkZXJDb250ZXh0DQogICAgICAgICAqLw0KICAgICAgICB0aGlzLiRzbGlkZXMgPSBudWxsOw0KICAgICAgICAvKioNCiAgICAgICAgICogalF1ZXJ5IG9iamVjdCBjb250YWluaW5nIGVsZW1lbnQgdGhhdCB3cmFwcHMgc2xpZGVzDQogICAgICAgICAqDQogICAgICAgICAqIEBtZW1iZXIgU2xpZGVyQ29udGV4dA0KICAgICAgICAgKi8NCiAgICAgICAgdGhpcy4kd3JhcHBlciA9IG51bGw7DQogICAgICAgIC8qKg0KICAgICAgICAgKiBSZWZlcmVuY2UgdG8gbWV0aG9kLCB3aGljaCBzaG91bGQgY2hhbmdlIGN1cnJlbnQgc2xpZGUNCiAgICAgICAgICoNCiAgICAgICAgICogQG1lbWJlciBTbGlkZXJDb250ZXh0DQogICAgICAgICAqLw0KICAgICAgICB0aGlzLmNoYW5nZUN1cnJlbnRTbGlkZSA9IG51bGw7DQogICAgICAgIC8qKg0KICAgICAgICAgKiBSZWZlcmVuY2UgdG8gbWV0aG9kLCB3aGljaCBzaG91bGQgcmV0dXJuIGpRdWVyeSBvYmplY3Qgd2l0aCBjdXJyZW50IHNsaWRlDQogICAgICAgICAqDQogICAgICAgICAqIEBtZW1iZXIgU2xpZGVyQ29udGV4dA0KICAgICAgICAgKi8NCiAgICAgICAgdGhpcy5nZXRDdXJyZW50U2xpZGUgPSBudWxsOw0KDQogICAgICAgIHRoaXMudGltZXJzLnB1c2godGhpcy5zbGlkZVRpbWVyKTsNCiAgICB9DQogICAgLyoqDQogICAgICogZW5kIG9mIFNsaWRlckNvbnRleHQgY2xhc3MNCiAgICAgKi8NCg0KICAgIC8qKg0KICAgICAqIFNsaWRlciBjbGFzcyBtYW5hZ2VzIGNoYW5naW5nIG9mIHNsaWRlcy4NCiAgICAgKg0KICAgICAqIE9wdGlvbnMgb2JqZWN0Og0KICAgICAqIHsNCiAgICAgKiAgICAgJ25hdmlnYXRpb24nOiBPYmplY3QgdmFsdWUsIC8vbmF2aWdhdGlvbiBzZXR0aW5ncyBvYmplY3QNCiAgICAgKiAgICAgJ3RpbWVvdXQnOiBOdW1iZXIgdmFsdWUsIC8vdGltZSBiZXR3ZWVuIHNsaWRlcyBjaGFuZ2luZw0KICAgICAqICAgICAndHJhbnNpdGlvbic6IFN0cmluZyB2YWx1ZSwgLy9uYW1lIG9mIHRyYW5zaXRpb24gY2xhc3MgKEBzZWUgWEEuY29tcG9uZW50LmNhcm91c2Vscy5UcmFuc2l0aW9ucy5UcmFuc2l0aW9uKQ0KICAgICAqICAgICAnaXNQYXVzZUVuYWJsZWQnOiBCb29sZWFuIHZhbHVlLCAvL2ZsYWcsIHdoaWNoIGRldGVybWluZXMgaWYgcGF1c2UgZmVhdHVyZSBpcyBlbmFibGVkDQogICAgICogICAgICd0aW1lSW5kaWNhdG9yJzogew0KICAgICAqICAgICAgICAgJ2lzRW5hYmxlZCc6IEJvb2xlYW4gdmFsdWUsIC8vZmxhZywgd2hpY2ggZGV0ZXJtaW5lcyBpZiB0aW1lIGluZGljYXRvciBpcyBlbmFibGVkDQogICAgICogICAgICAgICAnc2VsZWN0b3InOiBTdHJpbmcgdmFsdWUsIC8vc2VsZWN0b3Igb2YgdGltZSBpbmRpY2F0b3IgaHRtbCBlbGVtZW50DQogICAgICogICAgICAgICAndmlldyc6IFN0cmluZyB2YWx1ZSwgLy9uYW1lIG9mIHZpZXcgY2xhc3MgKEBzZWUgWEEuY29tcG9uZW50LmNhcm91c2Vscy5JbmRpY2F0b3JWaWV3cy5WaWV3DQogICAgICogICAgICAgICAnb3B0aW9ucyc6IE9iamVjdCB2YWx1ZSAvL29iamVjdCB3aXRoIG9wdGlvbnMsIHdoaWNoIHdpbGwgYmUgcGFzc2VkIHRvIGEgdGltZSBpbmRpY2F0b3Igdmlldw0KICAgICAqICAgICB9DQogICAgICogfQ0KICAgICAqIEBjb25zdHJ1Y3Rvcg0KICAgICAqIEBwYXJhbSB7T2JqZWN0fSAkICAgICB0aGUgalF1ZXJ5IG9iamVjdA0KICAgICAqIEBwYXJhbSB7U2xpZGVyQ29udGV4dH0gY29udGV4dCAgICBpbnN0YW5jZSBvZiBTbGlkZXJDb250ZXh0IGNsYXNzOyBtdXN0IGJlIHNlcGFyYXRlIGZvciBlYWNoIGluc3RhbmNlIChAc2VlIFNsaWRlckNvbnRleHQpDQogICAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgICAgU2xpZGVyIG9wdGlvbnMgb2JqZWN0DQogICAgICovDQogICAgZnVuY3Rpb24gU2xpZGVyKCQsIGNvbnRleHQsIG9wdGlvbnMpIHsNCiAgICAgICAgdmFyIGRlZmF1bHRzID0gew0KICAgICAgICAgICAgJ25hdmlnYXRpb24nOiB7fSwNCiAgICAgICAgICAgICd0aW1lb3V0JzogMTAwMDAsDQogICAgICAgICAgICAndHJhbnNpdGlvbic6ICdCYXNpY1RyYW5zaXRpb24nLA0KICAgICAgICAgICAgJ2lzUGF1c2VFbmFibGVkJzogdHJ1ZSwNCiAgICAgICAgICAgICd0aW1lSW5kaWNhdG9yJzogew0KICAgICAgICAgICAgICAgICdpc0VuYWJsZWQnOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAnc2VsZWN0b3InOiBudWxsLA0KICAgICAgICAgICAgICAgICd2aWV3JzogJ1ZpZXcnLA0KICAgICAgICAgICAgICAgICdvcHRpb25zJzoge30NCiAgICAgICAgICAgIH0NCiAgICAgICAgfTsNCg0KICAgICAgICAvKioNCiAgICAgICAgICogSW5zdGFuY2Ugb2YgU2xpZGVyQ29udGV4dCBjbGFzcyAoQHNlZSBTbGlkZXJDb250ZXh0KQ0KICAgICAgICAgKg0KICAgICAgICAgKiBAbWVtYmVyIE5hdmlnYXRpb24NCiAgICAgICAgICovDQogICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7DQoNCiAgICAgICAgY29udGV4dC5vd25lciA9IHRoaXM7DQogICAgICAgIGNvbnRleHQuZGVmYXVsdHMgPSBkZWZhdWx0czsNCiAgICAgICAgY29udGV4dC5zZXR0aW5ncyA9ICQuZXh0ZW5kKHRydWUsIHt9LCBkZWZhdWx0cywgb3B0aW9ucyk7DQogICAgICAgIGNvbnRleHQudHJhbnNpdGlvblNldHRpbmdzLiRzbGlkZXMgPSBjb250ZXh0LiRzbGlkZXM7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogRXhlY3V0ZXMgbWV0aG9kIHdpdGggZ2l2ZW4gbWV0aG9kTmFtZSBvbiBlYWNoIFRpbWVyIGluIGNvbnRleHQudGltZXJzIChAc2VlIFRpbWVyKQ0KICAgICAqDQogICAgICogQG1lbWJlciBTbGlkZXINCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbWV0aG9kTmFtZSAgIG5hbWUgb2YgYSBtZXRob2QsIHdoaWNoIHdpbGwgYmUgZXhlY3V0ZWQgb24gdGltZXJzDQogICAgICogQHBhcmFtIHtTbGlkZXJDb250ZXh0fSBjb250ZXh0ICAgIGN1cnJlbnQgY29udGV4dA0KICAgICAqLw0KICAgIFNsaWRlci5wcm90b3R5cGUuZXhlY3V0ZU9uVGltZXJzID0gZnVuY3Rpb24obWV0aG9kTmFtZSwgY29udGV4dCkgew0KICAgICAgICB2YXIgaSA9IG51bGwsDQogICAgICAgICAgICB0aW1lciA9IG51bGwsDQogICAgICAgICAgICB0aW1lcnMgPSBjb250ZXh0LnRpbWVyczsNCg0KICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdGltZXJzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICB0aW1lciA9IHRpbWVyc1tpXTsNCiAgICAgICAgICAgIGlmICh0eXBlb2YodGltZXJbbWV0aG9kTmFtZV0pID09PSAnZnVuY3Rpb24nKSB7DQogICAgICAgICAgICAgICAgdGltZXJbbWV0aG9kTmFtZV0oKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH07DQoNCiAgICAvKioNCiAgICAgKiBEZXNjaGVkdWxlcyBjaGFuZ2Ugb2YgYSBzbGlkZSwgYnkgY2xlYXJpbmcgdGltZW91dCBwcmV2aW91c2x5IHNldCBieSBzZXRUaWVtb3V0KCkgZnVuY3Rpb24uDQogICAgICoNCiAgICAgKiBAbWVtYmVyIFNsaWRlcg0KICAgICAqIEBwYXJhbSB7U2xpZGVyQ29udGV4dH0gY29udGV4dCAgICBjdXJyZW50IGNvbnRleHQNCiAgICAgKi8NCiAgICBTbGlkZXIucHJvdG90eXBlLmRlc2NoZWR1bGVTbGlkZSA9IGZ1bmN0aW9uKGNvbnRleHQpIHsNCiAgICAgICAgaWYgKGNvbnRleHQudGltZW91dElkICE9PSBudWxsKSB7DQogICAgICAgICAgICBjbGVhclRpbWVvdXQoY29udGV4dC50aW1lb3V0SWQpOw0KICAgICAgICAgICAgY29udGV4dC50aW1lb3V0SWQgPSBudWxsOw0KICAgICAgICB9DQogICAgfTsNCg0KICAgIC8qKg0KICAgICAqIFNjaGVkdWxlcyBjaGFuZ2Ugb2YgYSBzbGlkZSwgYnkgc2V0dGluZyB0aW1lb3V0ICh1c2luZyBzZXRUaWVtb3V0KCkgZnVuY3Rpb24pIGlmIGNhbi4NCiAgICAgKiBJZiBjYW4ndCwgdHJpZXMgYWdhaW4gYWZ0ZXIgc2hvcnQgcGVyaW9kIG9mIHRpbWUuDQogICAgICoNCiAgICAgKiBAbWVtYmVyIFNsaWRlcg0KICAgICAqIEBwYXJhbSB7U2xpZGVyQ29udGV4dH0gY29udGV4dCAgICBjdXJyZW50IGNvbnRleHQNCiAgICAgKi8NCiAgICBTbGlkZXIucHJvdG90eXBlLnNjaGVkdWxlU2xpZGUgPSBmdW5jdGlvbihjb250ZXh0KSB7DQogICAgICAgIHZhciBvd25lciA9IGNvbnRleHQub3duZXI7DQoNCiAgICAgICAgb3duZXIuZGVzY2hlZHVsZVNsaWRlKGNvbnRleHQpOw0KDQogICAgICAgIGlmICghY29udGV4dC5wcmV2ZW50U2NoZWR1bGluZyAmJiBjb250ZXh0LiRzbGlkZXMuc2l6ZSgpID4gMSkgew0KICAgICAgICAgICAgb3duZXIuZXhlY3V0ZU9uVGltZXJzKCdzZXQnLCBjb250ZXh0KTsNCg0KICAgICAgICAgICAgaWYgKGNvbnRleHQuY2FuQ2hhbmdlU2xpZGUpIHsNCiAgICAgICAgICAgICAgICBpZiAoY29udGV4dC50aW1lSW5kaWNhdG9yICE9PSBudWxsKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnRleHQudGltZUluZGljYXRvci5wbGF5KCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGNvbnRleHQudGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgb3duZXIuY2hhbmdlQ3VycmVudFNsaWRlQnkoMSwgY29udGV4dCk7DQogICAgICAgICAgICAgICAgfSwgY29udGV4dC5zZXR0aW5ncy50aW1lb3V0IC0gY29udGV4dC5zbGlkZVRpbWVyLmVsYXBzZWQpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICBvd25lci5zY2hlZHVsZVNsaWRlKGNvbnRleHQpOw0KICAgICAgICAgICAgICAgIH0sIDEwMCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgLyoqDQogICAgICogQ2hhbmdlcyBjdXJyZW50IHNsaWRlLCBieSBvZmZzZXQgcGVyZm9ybWluZyBjb250ZXh0LnRyYW5zaXRpb24NCiAgICAgKiBBbnkgb2Zmc2V0IHZhbHVlIGlzIHNhdmUgKGlmIGl0IGlzIGFuIGludGVnZXIpLg0KICAgICAqDQogICAgICogQG1lbWJlciBTbGlkZXINCiAgICAgKiBAcGFyYW0ge051bWJlcn0gb2Zmc2V0ICAgIHRoZSBvZmZzZXQgdG8gYW4gaW5kZXggb2YgYSBuZXcgc2xpZGUNCiAgICAgKiBAcGFyYW0ge1NsaWRlckNvbnRleHR9IGNvbnRleHQgICAgY3VycmVudCBjb250ZXh0DQogICAgICovDQogICAgU2xpZGVyLnByb3RvdHlwZS5jaGFuZ2VDdXJyZW50U2xpZGVCeSA9IGZ1bmN0aW9uKG9mZnNldCwgY29udGV4dCkgew0KICAgICAgICB2YXIgc2V0dGluZ3MgPSBjb250ZXh0LnRyYW5zaXRpb25TZXR0aW5ncywNCiAgICAgICAgICAgICRjdXJyZW50U2xpZGUgPSBjb250ZXh0LmdldEN1cnJlbnRTbGlkZSgpLA0KICAgICAgICAgICAgJHNsaWRlcyA9IGNvbnRleHQuJHNsaWRlczsNCg0KICAgICAgICBpZiAoKG9mZnNldCAlICRzbGlkZXMuc2l6ZSgpKSAhPT0gMCkgew0KICAgICAgICAgICAgY29udGV4dC5jYW5DaGFuZ2VTbGlkZSA9IGZhbHNlOw0KDQogICAgICAgICAgICBzZXR0aW5ncy5vZmZzZXQgPSBvZmZzZXQ7DQogICAgICAgICAgICBzZXR0aW5ncy4kY3VycmVudFNsaWRlID0gJGN1cnJlbnRTbGlkZTsNCiAgICAgICAgICAgIHNldHRpbmdzLiRuZXh0U2xpZGUgPSAkc2xpZGVzLmVxKCgkY3VycmVudFNsaWRlLmluZGV4KCkgKyBvZmZzZXQpICUgJHNsaWRlcy5zaXplKCkpOw0KDQogICAgICAgICAgICBjb250ZXh0LmNoYW5nZUN1cnJlbnRTbGlkZShzZXR0aW5ncy4kbmV4dFNsaWRlKTsNCiAgICAgICAgICAgIGNvbnRleHQudHJhbnNpdGlvbi5wZXJmb3JtKGNvbnRleHQudHJhbnNpdGlvblNldHRpbmdzKTsNCiAgICAgICAgICAgIGNvbnRleHQub3duZXIuZXhlY3V0ZU9uVGltZXJzKCdyZXNldCcsIGNvbnRleHQpOw0KICAgICAgICB9DQoNCg0KICAgICAgICB2YXIgJGNhcm91c2VsID0gJChjb250ZXh0LiR3cmFwcGVyKS5wYXJlbnRzKCIuY2Fyb3VzZWwiKTsNCiAgICAgICAgJGNhcm91c2VsLnRyaWdnZXIoInNsaWRlLWNoYW5nZWQiKTsNCiAgICB9Ow0KDQogICAgLyoqDQogICAgICogU3RhcnRzIGF1dG9tYXRpYyBzbGlkZXMgY2hhbmdpbmcNCiAgICAgKg0KICAgICAqIEBtZW1iZXIgU2xpZGVyDQogICAgICovDQogICAgU2xpZGVyLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgdGhpcy5leGVjdXRlT25UaW1lcnMoJ3Jlc2V0JywgdGhpcy5jb250ZXh0KTsNCiAgICAgICAgdGhpcy5zY2hlZHVsZVNsaWRlKHRoaXMuY29udGV4dCk7DQogICAgfTsNCg0KICAgIC8qKg0KICAgICAqIENhbmNlbCB0aGUgZGVmYXVsdCBhY3Rpb24gb2YgZXZlbnQgYW5kIGNoYW5nZXMgc2xpZGUgbWFudWFsbHkuDQogICAgICoNCiAgICAgKiBAbWVtYmVyIFNsaWRlcg0KICAgICAqIEBwYXJhbSB7T2JqZWN0fSBldmVudCAgICAgdGhlIGV2ZW50DQogICAgICogQHBhcmFtIHtOdW1iZXJ9IG9mZnNldCAgICB0aGUgb2Zmc2V0IHRvIGFuIGluZGV4IG9mIGEgbmV3IHNsaWRlDQogICAgICogQHBhcmFtIHtTbGlkZXJDb250ZXh0fSBjb250ZXh0ICAgIGN1cnJlbnQgY29udGV4dA0KICAgICAqLw0KICAgIFNsaWRlci5wcm90b3R5cGUub25DaGFuZ2VDdXJyZW50U2xpZGUgPSBmdW5jdGlvbihldmVudCwgb2Zmc2V0LCBjb250ZXh0KSB7DQogICAgICAgIHZhciBvd25lciA9IGNvbnRleHQub3duZXI7DQoNCiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgaWYgKGNvbnRleHQuY2FuQ2hhbmdlU2xpZGUpIHsNCiAgICAgICAgICAgIG93bmVyLmRlc2NoZWR1bGVTbGlkZShjb250ZXh0KTsNCiAgICAgICAgICAgIG93bmVyLmNoYW5nZUN1cnJlbnRTbGlkZUJ5KG9mZnNldCwgY29udGV4dCk7DQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgLyoqDQogICAgICogU2VsZWN0cyBuYXZpZ2F0aW9uIGl0ZW0gd2l0aCBnaXZlbiBpbmRleC4NCiAgICAgKg0KICAgICAqIEBtZW1iZXIgU2xpZGVyDQogICAgICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4ICAgICB0aGUgaW5kZXggb2YgbmF2aWdhdGlvbiBpdGVtDQogICAgICovDQogICAgU2xpZGVyLnByb3RvdHlwZS5zZWxlY3ROYXZpZ2F0aW9uSXRlbSA9IGZ1bmN0aW9uKGluZGV4KSB7DQogICAgICAgIHRoaXMuY29udGV4dC5uYXZpZ2F0aW9uLnNlbGVjdEl0ZW0oaW5kZXgpOw0KICAgIH07DQogICAgLyoqDQogICAgICogZW5kIG9mIFNsaWRlciBjbGFzcw0KICAgICAqLw0KDQogICAgLyoqDQogICAgICogU2xpZGVySW5pdGlhbGl6ZXIgb2JqZWN0IHNldCB1cCBpbnN0YW5jZXMgb2YgU2xpZGVyIGNsYXNzDQogICAgICovDQogICAgU2xpZGVySW5pdGlhbGl6ZXIgPSAoZnVuY3Rpb24oJCkgew0KICAgICAgICAvKioNCiAgICAgICAgICogQXR0YWNoZXMgZXZlbnRzIHRvIG5hdmlnYXRpb24gaXRlbXMuDQogICAgICAgICAqDQogICAgICAgICAqIEBwYXJhbSB7U2xpZGVyQ29udGV4dH0gY29udGV4dCAgIGEgY29udGV4dCBvZiBhIFNsaWRlciBjbGFzcyBpbnN0YW5jZQ0KICAgICAgICAgKi8NCiAgICAgICAgZnVuY3Rpb24gYXR0YWNoTmF2aWdhdGlvbkV2ZW50cyhjb250ZXh0KSB7DQogICAgICAgICAgICB2YXIgb3duZXIgPSBjb250ZXh0Lm93bmVyLA0KICAgICAgICAgICAgICAgICRuYXZMaW5rcyA9IGNvbnRleHQuJHdyYXBwZXIuZmluZCgiLm5hdiBhIiksDQogICAgICAgICAgICAgICAgJHByZXZJdGVtVHh0ID0gY29udGV4dC4kd3JhcHBlci5maW5kKCcucHJldi10ZXh0JyksDQogICAgICAgICAgICAgICAgJG5leHRJdGVtVHh0ID0gY29udGV4dC4kd3JhcHBlci5maW5kKCcubmV4dC10ZXh0Jyk7DQoNCiAgICAgICAgICAgIGNvbnRleHQubmF2aWdhdGlvbi4kaXRlbXMuZWFjaChmdW5jdGlvbihpbmRleCkgew0KICAgICAgICAgICAgICAgIHZhciAkc2xpZGUgPSBjb250ZXh0LiRzbGlkZXMuZXEoaW5kZXgpOw0KDQogICAgICAgICAgICAgICAgJCh0aGlzKS5jbGljayhmdW5jdGlvbihldmVudCkgew0KICAgICAgICAgICAgICAgICAgICBvd25lci5vbkNoYW5nZUN1cnJlbnRTbGlkZShldmVudCwgJHNsaWRlLmluZGV4KCkgLSBjb250ZXh0LmdldEN1cnJlbnRTbGlkZSgpLmluZGV4KCksIGNvbnRleHQpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICRwcmV2SXRlbVR4dC5jbGljayhmdW5jdGlvbihldmVudCkgew0KICAgICAgICAgICAgICAgIG93bmVyLm9uQ2hhbmdlQ3VycmVudFNsaWRlKGV2ZW50LCAtMSwgY29udGV4dCk7DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgJG5leHRJdGVtVHh0LmNsaWNrKGZ1bmN0aW9uKGV2ZW50KSB7DQogICAgICAgICAgICAgICAgb3duZXIub25DaGFuZ2VDdXJyZW50U2xpZGUoZXZlbnQsIDEsIGNvbnRleHQpOw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIGNvbnRleHQubmF2aWdhdGlvbi4kcHJldkl0ZW0uY2xpY2soZnVuY3Rpb24oZXZlbnQpIHsNCiAgICAgICAgICAgICAgICBvd25lci5vbkNoYW5nZUN1cnJlbnRTbGlkZShldmVudCwgLTEsIGNvbnRleHQpOw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIGNvbnRleHQubmF2aWdhdGlvbi4kbmV4dEl0ZW0uY2xpY2soZnVuY3Rpb24oZXZlbnQpIHsNCiAgICAgICAgICAgICAgICBvd25lci5vbkNoYW5nZUN1cnJlbnRTbGlkZShldmVudCwgMSwgY29udGV4dCk7DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgJG5hdkxpbmtzLm9uKCJrZXlkb3duIiwgZnVuY3Rpb24oZXZlbnQpew0KICAgICAgICAgICAgICAgIHN3aXRjaChldmVudC5rZXlDb2RlKXsNCiAgICAgICAgICAgICAgICAgICAgY2FzZSAzNzoNCiAgICAgICAgICAgICAgICAgICAgICAgIG93bmVyLm9uQ2hhbmdlQ3VycmVudFNsaWRlKGV2ZW50LCAtMSwgY29udGV4dCk7DQogICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmZpbmQoIi5hY3RpdmUiKS5mb2N1cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgMzk6DQogICAgICAgICAgICAgICAgICAgICAgICBvd25lci5vbkNoYW5nZUN1cnJlbnRTbGlkZShldmVudCwgMSwgY29udGV4dCk7DQogICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmZpbmQoIi5hY3RpdmUiKS5mb2N1cygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCg0KICAgICAgICAvKioNCiAgICAgICAgICogQXR0YWNoZXMgcGF1c2UgZXZlbnQgdG8gbmF2aWdhdGlvbiB3cmFwcGVyLg0KICAgICAgICAgKg0KICAgICAgICAgKiBAcGFyYW0ge1NsaWRlckNvbnRleHR9IGNvbnRleHQgICBhIGNvbnRleHQgb2YgYSBTbGlkZXIgY2xhc3MgaW5zdGFuY2UNCiAgICAgICAgICovDQogICAgICAgIGZ1bmN0aW9uIGF0dGFjaFBhdXNlRXZlbnQoY29udGV4dCkgew0KICAgICAgICAgICAgdmFyIG93bmVyID0gY29udGV4dC5vd25lciwNCiAgICAgICAgICAgICAgICAkZWxlbWVudCA9IGNvbnRleHQuJHdyYXBwZXIsDQogICAgICAgICAgICAgICAgJG5hdkxpbmtzID0gJGVsZW1lbnQuZmluZCgiLm5hdiBhIik7DQoNCiAgICAgICAgICAgIHZhciBjYWxsYmFja01vdXNlZW50ZXIgPSBmdW5jdGlvbigpew0KICAgICAgICAgICAgICAgIGNvbnRleHQucHJldmVudFNjaGVkdWxpbmcgPSB0cnVlOw0KICAgICAgICAgICAgICAgIG93bmVyLmRlc2NoZWR1bGVTbGlkZShjb250ZXh0KTsNCg0KICAgICAgICAgICAgICAgIG93bmVyLmV4ZWN1dGVPblRpbWVycygndXBkYXRlJywgY29udGV4dCk7DQogICAgICAgICAgICAgICAgaWYgKGNvbnRleHQudGltZUluZGljYXRvciAhPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICBjb250ZXh0LnRpbWVJbmRpY2F0b3IucGF1c2UoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICRlbGVtZW50Lm1vdXNlZW50ZXIoY2FsbGJhY2tNb3VzZWVudGVyKTsNCiAgICAgICAgICAgICRuYXZMaW5rcy5vbigiZm9jdXMiLCBjYWxsYmFja01vdXNlZW50ZXIpOw0KDQogICAgICAgICAgICB2YXIgY2FsbGJhY2tNb3VzZUxlYXZlID0gZnVuY3Rpb24oKXsNCiAgICAgICAgICAgICAgICBjb250ZXh0LnByZXZlbnRTY2hlZHVsaW5nID0gZmFsc2U7DQogICAgICAgICAgICAgICAgb3duZXIuc2NoZWR1bGVTbGlkZShjb250ZXh0KTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgJGVsZW1lbnQubW91c2VsZWF2ZShjYWxsYmFja01vdXNlTGVhdmUpOw0KICAgICAgICAgICAgJG5hdkxpbmtzLm9uKCJibHVyIiwgY2FsbGJhY2tNb3VzZUxlYXZlKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBDcmVhdGVzIHRpbWUgaW5kaWNhdG9yIHZpZXcNCiAgICAgICAgICoNCiAgICAgICAgICogQHBhcmFtIHtTbGlkZXJDb250ZXh0fSBjb250ZXh0ICAgYSBjb250ZXh0IG9mIGEgU2xpZGVyIGNsYXNzIGluc3RhbmNlDQogICAgICAgICAqLw0KICAgICAgICBmdW5jdGlvbiBjcmVhdGVJbmRpY2F0b3IoY29udGV4dCkgew0KICAgICAgICAgICAgdmFyIHNldHRpbmdzID0gY29udGV4dC5zZXR0aW5ncywNCiAgICAgICAgICAgICAgICB0aW1lSW5kaWNhdG9yID0gbnVsbCwNCiAgICAgICAgICAgICAgICBWaWV3Q29uc3RydWN0b3IgPSBYQS5jb21wb25lbnQuY2Fyb3VzZWxzLkluZGljYXRvclZpZXdzW3NldHRpbmdzLnRpbWVJbmRpY2F0b3Iudmlld10sDQogICAgICAgICAgICAgICAgdmlldyA9IG51bGw7DQoNCiAgICAgICAgICAgIGlmIChWaWV3Q29uc3RydWN0b3IgIT09IG51bGwpIHsNCiAgICAgICAgICAgICAgICB2aWV3ID0gbmV3IFZpZXdDb25zdHJ1Y3RvcihzZXR0aW5ncy50aW1lSW5kaWNhdG9yLnNlbGVjdG9yLCBzZXR0aW5ncy50aW1lSW5kaWNhdG9yLm9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIHRpbWVJbmRpY2F0b3IgPSBuZXcgVGltZUluZGljYXRvcigkLCB2aWV3LCBzZXR0aW5ncy50aW1lb3V0KTsNCiAgICAgICAgICAgICAgICBjb250ZXh0LnRpbWVJbmRpY2F0b3IgPSB0aW1lSW5kaWNhdG9yOw0KICAgICAgICAgICAgICAgIGNvbnRleHQudGltZXJzLnB1c2godGltZUluZGljYXRvcik7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvKioNCiAgICAgICAgICogQXR0YWNoZXMgZXZlbnRzIHRvIG5hdmlnYXRpb24uDQogICAgICAgICAqDQogICAgICAgICAqIEBwYXJhbSB7U2xpZGVyQ29udGV4dH0gY29udGV4dCAgIGEgY29udGV4dCBvZiBhIFNsaWRlciBjbGFzcyBpbnN0YW5jZQ0KICAgICAgICAgKi8NCiAgICAgICAgZnVuY3Rpb24gaW5pdGlhbGl6ZU5hdmlnYXRpb24oY29udGV4dCkgew0KICAgICAgICAgICAgY29udGV4dC5zZXR0aW5ncy5uYXZpZ2F0aW9uLnNsaWRlc0NvdW50ID0gY29udGV4dC4kc2xpZGVzLmxlbmd0aDsNCiAgICAgICAgICAgIGNvbnRleHQubmF2aWdhdGlvbiA9IG5ldyBOYXZpZ2F0aW9uKCQsIGNvbnRleHQuJHdyYXBwZXIsIGNvbnRleHQuc2V0dGluZ3MubmF2aWdhdGlvbik7DQogICAgICAgICAgICBhdHRhY2hOYXZpZ2F0aW9uRXZlbnRzKGNvbnRleHQpOw0KDQogICAgICAgICAgICBpZiAoY29udGV4dC5zZXR0aW5ncy5pc1BhdXNlRW5hYmxlZCkgew0KICAgICAgICAgICAgICAgIGF0dGFjaFBhdXNlRXZlbnQoY29udGV4dCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvKioNCiAgICAgICAgICogSW5pdGlhbGl6ZXMgdHJhbnNpdGlvbiBmb3IgYSBnaXZlbiBjb250ZXh0Lg0KICAgICAgICAgKg0KICAgICAgICAgKiBAcGFyYW0ge1NsaWRlckNvbnRleHR9IGNvbnRleHQgICBhIGNvbnRleHQgb2YgYSBTbGlkZXIgY2xhc3MgaW5zdGFuY2UNCiAgICAgICAgICovDQogICAgICAgIGZ1bmN0aW9uIGluaXRpYWxpemVUcmFuc2l0aW9uKGNvbnRleHQpIHsNCiAgICAgICAgICAgIHZhciBUcmFuc2l0aW9uQ29uc3RydWN0b3IgPSBudWxsLA0KICAgICAgICAgICAgICAgIG93bmVyID0gY29udGV4dC5vd25lcjsNCg0KICAgICAgICAgICAgY29udGV4dC50cmFuc2l0aW9uU2V0dGluZ3MuY2FsbGJhY2sgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBjb250ZXh0LmNhbkNoYW5nZVNsaWRlID0gdHJ1ZTsNCg0KICAgICAgICAgICAgICAgIGlmIChjb250ZXh0LnByZXZlbnRTY2hlZHVsaW5nKSB7DQogICAgICAgICAgICAgICAgICAgIG93bmVyLmV4ZWN1dGVPblRpbWVycygncmVzZXQnLCBjb250ZXh0KTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBvd25lci5zY2hlZHVsZVNsaWRlKGNvbnRleHQpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIFRyYW5zaXRpb25Db25zdHJ1Y3RvciA9IFhBLmNvbXBvbmVudC5jYXJvdXNlbHMuVHJhbnNpdGlvbnNbY29udGV4dC5zZXR0aW5ncy50cmFuc2l0aW9uXTsNCiAgICAgICAgICAgIGlmICgoVHJhbnNpdGlvbkNvbnN0cnVjdG9yID09PSBudWxsKSB8fCAoVHJhbnNpdGlvbkNvbnN0cnVjdG9yID09PSB1bmRlZmluZWQpKSB7DQogICAgICAgICAgICAgICAgVHJhbnNpdGlvbkNvbnN0cnVjdG9yID0gWEEuY29tcG9uZW50LmNhcm91c2Vscy5UcmFuc2l0aW9uc1tjb250ZXh0LmRlZmF1bHRzLnRyYW5zaXRpb25dOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgY29udGV4dC50cmFuc2l0aW9uID0gbmV3IFRyYW5zaXRpb25Db25zdHJ1Y3RvcigpOw0KICAgICAgICAgICAgY29udGV4dC50cmFuc2l0aW9uLmluaXQoY29udGV4dC50cmFuc2l0aW9uU2V0dGluZ3MpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgIC8qKg0KICAgICAgICAgICAgICogSW5pdGlhbGl6ZXMgU2xpZGVyIG9iamVjdCB3aXRoIGEgZ2l2ZW4gY29udGV4dC4NCiAgICAgICAgICAgICAqDQogICAgICAgICAgICAgKiBAcGFyYW0ge1NsaWRlckNvbnRleHR9IGNvbnRleHQgICBhIGNvbnRleHQgb2YgYSBTbGlkZXIgY2xhc3MgaW5zdGFuY2UNCiAgICAgICAgICAgICAqLw0KICAgICAgICAgICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oY29udGV4dCkgew0KICAgICAgICAgICAgICAgIGluaXRpYWxpemVOYXZpZ2F0aW9uKGNvbnRleHQpOw0KICAgICAgICAgICAgICAgIGluaXRpYWxpemVUcmFuc2l0aW9uKGNvbnRleHQpOw0KDQogICAgICAgICAgICAgICAgaWYgKGNvbnRleHQuc2V0dGluZ3MudGltZUluZGljYXRvci5pc0VuYWJsZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgY3JlYXRlSW5kaWNhdG9yKGNvbnRleHQpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfTsNCiAgICB9KCQpKTsNCiAgICAvKioNCiAgICAgKiBlbmQgb2YgU2xpZGVySW5pdGlhbGl6ZXINCiAgICAgKi8NCg0KICAgIC8qKg0KICAgICAqIENhcm91c2VsIGNsYXNzIGRpc3BsYXlzIG9uZSBzbGlkZSAoc29tZSBjb250ZW50KSBhdCB0aGUgdGltZS4NCiAgICAgKiBJdHMgYmVoYXZpb3VyIGRlcGVuZHMgb24gc2V0dGluZ3MgKHBhc3NlZCB0byBpbml0KCkgbWV0aG9kKS4NCiAgICAgKiBGb3IgbW9yZSBkZXRhaWxzIEBzZWUgU2xpZGVyLCBAc2VlIFNsaWRlckluaXRpYWxpemVyLCBAc2VlIE5hdmlnYXRpb24sDQogICAgICogQHNlZSBOYXZpZ2F0aW9uQnVpbGRlciwgQHNlZSBYQS5jb21wb25lbnQuY2Fyb3VzZWxzLlRyYW5zaXRpb25zLlRyYW5zaXRpb24sDQogICAgICogQHNlZSBYQS5jb21wb25lbnQuY2Fyb3VzZWxzLkluZGljYXRvclZpZXdzLlZpZXcNCiAgICAgKg0KICAgICAqIEBjb25zdHJ1Y3Rvcg0KICAgICAqLw0KICAgIGZ1bmN0aW9uIENhcm91c2VsKCQpIHsNCiAgICAgICAgdmFyIGNvbnRleHQgPSB0aGlzOw0KDQogICAgICAgIC8qKg0KICAgICAgICAgKiBJbnN0YW5jZSBvZiBhIFNsaWRlciBjbGFzcyAoQHNlZSBTbGlkZXIpLg0KICAgICAgICAgKg0KICAgICAgICAgKiBAbWVtYmVyIENhcm91c2VsDQogICAgICAgICAqLw0KICAgICAgICB0aGlzLnNsaWRlciA9IG51bGw7DQogICAgICAgIC8qKg0KICAgICAgICAgKiBEaXNwbGF5ZWQgc2xpZGUgKGpRdWVyeSBvYmplY3QpLg0KICAgICAgICAgKg0KICAgICAgICAgKiBAbWVtYmVyIENhcm91c2VsDQogICAgICAgICAqLw0KICAgICAgICB0aGlzLiRjdXJyZW50U2xpZGUgPSBudWxsOw0KICAgICAgICAvKioNCiAgICAgICAgICogQWxsIHNsaWRlcyAoalF1ZXJ5IG9iamVjdCkuDQogICAgICAgICAqDQogICAgICAgICAqIEBtZW1iZXIgQ2Fyb3VzZWwNCiAgICAgICAgICovDQogICAgICAgIHRoaXMuJHNsaWRlcyA9IG51bGw7DQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIENoYW5nZXMgY3VycmVudCBzbGlkZSB0byBhICRuZXdTbGlkZS4NCiAgICAgICAgICoNCiAgICAgICAgICogQG1lbWJlciBDYXJvdXNlbA0KICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gJG5ld1NsaWRlICB0aGUgbmV3IHNsaWRlIChqUXVlcnkpIG9iamVjdC4NCiAgICAgICAgICovDQogICAgICAgIHRoaXMuY2hhbmdlQ3VycmVudFNsaWRlID0gZnVuY3Rpb24oJG5ld1NsaWRlKSB7DQogICAgICAgICAgICBjb250ZXh0LiRjdXJyZW50U2xpZGUgPSAkbmV3U2xpZGU7DQogICAgICAgICAgICBjb250ZXh0LnNsaWRlci5zZWxlY3ROYXZpZ2F0aW9uSXRlbSgkbmV3U2xpZGUuaW5kZXgoKSk7DQogICAgICAgIH07DQoNCiAgICAgICAgLyoqDQogICAgICAgICAqIFJldHVybnMgY3VycmVudCBzbGlkZS4NCiAgICAgICAgICoNCiAgICAgICAgICogQG1lbWJlciBDYXJvdXNlbA0KICAgICAgICAgKiBAcmV0dXJuIGN1cnJlbnQgc2xpZGUgKGpRdWVyeSkgb2JqZWN0Lg0KICAgICAgICAgKiBAdHlwZSBPYmplY3QNCiAgICAgICAgICovDQogICAgICAgIHRoaXMuZ2V0Q3VycmVudFNsaWRlID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICByZXR1cm4gY29udGV4dC4kY3VycmVudFNsaWRlOw0KICAgICAgICB9Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFJlc2V0cyB0aGUgY2Fyb3VzZWwuDQogICAgICoNCiAgICAgKiBAbWVtYmVyIENhcm91c2VsDQogICAgICovDQogICAgQ2Fyb3VzZWwucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKSB7DQogICAgICAgIHRoaXMuJHNsaWRlcy5lYWNoKGZ1bmN0aW9uKGluZGV4KSB7DQogICAgICAgICAgICAkKHRoaXMpLmhpZGUoKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgdGhpcy5jaGFuZ2VDdXJyZW50U2xpZGUodGhpcy4kc2xpZGVzLmZpcnN0KCkpOw0KICAgICAgICB0aGlzLiRjdXJyZW50U2xpZGUuc2hvdygpOw0KICAgIH07DQoNCiAgICAvKioNCiAgICAgKiBJbml0aWFsaXplcyB0aGUgY2Fyb3VzZWwuDQogICAgICogV3JhcHBzIGNhcm91c2VsIGNvbnRlbnQgd2l0aCA8ZGl2IGNsYXNzPSJ3cmFwcGVyIiAvPiBlbGVtZW50LA0KICAgICAqIHNlbGVjdHMgc2xpZGVzICg8bGkgLz4gZWxlbWVudHMpIGZyb20gPHVsIGNsYXNzPSJzbGlkZXMiIC8+IGVsZW1lbnQsDQogICAgICogaW5pdGlhbGl6ZXMgU2xpZGVyIGNsYXNzIGluY3RhbmNlLCByZXNldHMgdGhlIGNhcm91c2VsIGFuZCBzdGFydCBhdXRvbWF0aWMgc2xpZGVzIGNoYW5naW5nLg0KICAgICAqDQogICAgICogQG1lbWJlciBDYXJvdXNlbA0KICAgICAqIEBwYXJhbSB7T2JqZWN0fSAkY29udGFpbmVyICAgICBqUXVlcnkgb2JqZWN0IHdpdGggYSBtYWluIGh0bWwgZWxlbWVudCBvZiB0aGUgY2Fyb3VzZWwNCiAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyAgICAgY2Fyb3VzZWwgb3B0aW9ucyBvYmplY3QNCiAgICAgKi8NCiAgICBDYXJvdXNlbC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCRjb250YWluZXIsIG9wdGlvbnMpIHsNCiAgICAgICAgdmFyICR3cmFwcGVyID0gJCgnPGRpdi8+Jywgew0KICAgICAgICAgICAgICAgICdjbGFzcyc6ICd3cmFwcGVyJw0KICAgICAgICAgICAgfSksDQogICAgICAgICAgICBzbGlkZXJDb250ZXh0ID0gbnVsbDsNCg0KICAgICAgICAkd3JhcHBlci5hcHBlbmQoJGNvbnRhaW5lci5jaGlsZHJlbigpLmRldGFjaCgpKTsNCiAgICAgICAgJGNvbnRhaW5lci5hcHBlbmQoJHdyYXBwZXIpOw0KICAgICAgICB0aGlzLiRzbGlkZXMgPSAkY29udGFpbmVyLmZpbmQoJy5zbGlkZXMgbGkuc2xpZGUnKTsNCg0KICAgICAgICBzbGlkZXJDb250ZXh0ID0gbmV3IFNsaWRlckNvbnRleHQoKTsNCiAgICAgICAgc2xpZGVyQ29udGV4dC5jaGFuZ2VDdXJyZW50U2xpZGUgPSB0aGlzLmNoYW5nZUN1cnJlbnRTbGlkZTsNCiAgICAgICAgc2xpZGVyQ29udGV4dC5nZXRDdXJyZW50U2xpZGUgPSB0aGlzLmdldEN1cnJlbnRTbGlkZTsNCiAgICAgICAgc2xpZGVyQ29udGV4dC4kc2xpZGVzID0gdGhpcy4kc2xpZGVzOw0KICAgICAgICBzbGlkZXJDb250ZXh0LiR3cmFwcGVyID0gJHdyYXBwZXI7DQoNCiAgICAgICAgdGhpcy5zbGlkZXIgPSBuZXcgU2xpZGVyKCQsIHNsaWRlckNvbnRleHQsIG9wdGlvbnMpOw0KICAgICAgICBTbGlkZXJJbml0aWFsaXplci5pbml0aWFsaXplKHNsaWRlckNvbnRleHQpOw0KDQogICAgICAgIHRoaXMucmVzZXQoKTsNCiAgICAgICAgdGhpcy5zbGlkZXIucnVuKCk7DQogICAgfTsNCiAgICAvKioNCiAgICAgKiBlbmQgb2YgQ2Fyb3VzZWwgY2xhc3MNCiAgICAgKi8NCg0KICAgIC8qKg0KICAgICAqIFJlZ2lzdGVycyBlYWNoIGVsZW1lbnRzIHRoYXQgbWF0Y2ggdGhlIHByb3ZpZGVkIHNlbGVjdG9yIGFzIGEgY2Fyb3VzZWwgd2l0aCBhIGdpdmVuIG9wdGlvbnMuDQogICAgICogQ2Fyb3VzZWwgb3B0aW9ucyBvYmplY3QgOg0KICAgICAqIHsNCiAgICAgKiAgICAgLy8NCiAgICAgKiAgICAgLy8gbmF2aWdhdGlvbjogT2JqZWN0DQogICAgICogICAgIC8vDQogICAgICogICAgIC8vIFRoZSBuYXZpZ2F0aW9uIGNvbmZpZ3VyYXRpb24gb2JqZWN0Lg0KICAgICAqICAgICAvLw0KICAgICAqICAgICAnbmF2aWdhdGlvbic6IHsNCiAgICAgKiAgICAgICAgIC8vDQogICAgICogICAgICAgICAvL2lzRW5hYmxlZDogQm9vbGVhbg0KICAgICAqICAgICAgICAgLy8NCiAgICAgKiAgICAgICAgIC8vIFNldHMgd2hldGhlciB0aGUgbmF2aWdhdGlvbiBpcyBlbmFibGVkLg0KICAgICAqICAgICAgICAgLy8NCiAgICAgKiAgICAgICAgICdpc0VuYWJsZWQnOiB0cnVlLA0KICAgICAqICAgICAgICAgLy8NCiAgICAgKiAgICAgICAgIC8vIGhhc1ByZXZOZXh0SXRlbXM6IEJvb2xlYW4NCiAgICAgKiAgICAgICAgIC8vDQogICAgICogICAgICAgICAvLyBTZXRzIHdoZXRoZXIgdGhlIG5hdmlnYXRpb24gaGFzIHByZXZpb3VzIGFuZCBuZXh0IGJ1dHRvbnMuDQogICAgICogICAgICAgICAvLw0KICAgICAqICAgICAgICAgJ2hhc1ByZXZOZXh0SXRlbXMnOiB0cnVlLA0KICAgICAqICAgICAgICAgLy8NCiAgICAgKiAgICAgICAgIC8vIGl0ZW06IE9iamVjdA0KICAgICAqICAgICAgICAgLy8NCiAgICAgKiAgICAgICAgIC8vIE5hdmlnYXRpb24gaXRlbSBjb25maWd1cmF0aW9uIG9iamVjdC4NCiAgICAgKiAgICAgICAgIC8vDQogICAgICogICAgICAgICAnaXRlbSc6IHsNCiAgICAgKiAgICAgICAgICAgICAvLw0KICAgICAqICAgICAgICAgICAgIC8vIGxhYmVsOiBTdHJpbmcNCiAgICAgKiAgICAgICAgICAgICAvLw0KICAgICAqICAgICAgICAgICAgIC8vIExhYmVsIHRlbXBsYXRlOyBlYWNoICcje2luZGV4fScgc3RyaW5nIHdpbGwgYmUgcmVwbGFjZWQgYnkgdGhlIG51bWJlciBvZiBhIHNsaWRlLg0KICAgICAqICAgICAgICAgICAgIC8vDQogICAgICogICAgICAgICAgICAgJ2xhYmVsJzogJyN7aW5kZXh9JywNCiAgICAgKiAgICAgICAgICAgICAvLw0KICAgICAqICAgICAgICAgICAgIC8vIHNlbGVjdG9yOiBTdHJpbmcNCiAgICAgKiAgICAgICAgICAgICAvLw0KICAgICAqICAgICAgICAgICAgIC8vIE5hdmlnYXRpb24gaXRlbXMgY29udGFpbmVyIHNlbGVjdG9yOyBpZiBlcXVhbHMgbnVsbCwgdGhlIGNvbnRhaW5lciB3aWxsIGJlIGdlbmVyYXRlZA0KICAgICAqICAgICAgICAgICAgIC8vICgnZGl2JyBlbGVtZW50IHdpdGggJ25hdicgY2xhc3MgYXR0cmlidXRlIGluc2lkZSB0aGUgY2Fyb3VzZWwpLg0KICAgICAqICAgICAgICAgICAgIC8vDQogICAgICogICAgICAgICAgICAgJ3NlbGVjdG9yJzogbnVsbA0KICAgICAqICAgICAgICB9LA0KICAgICAqICAgICAgICAgLy8NCiAgICAgKiAgICAgICAgIC8vIHByZXZJdGVtOiBPYmplY3QNCiAgICAgKiAgICAgICAgIC8vDQogICAgICogICAgICAgICAvLyBOYXZpZ2F0aW9uICdwcmV2aW91cyBpdGVtJyBjb25maWd1cmF0aW9uIG9iamVjdC4NCiAgICAgKiAgICAgICAgIC8vDQogICAgICogICAgICAgICAncHJldkl0ZW0nOiB7DQogICAgICogICAgICAgICAgICAgLy8NCiAgICAgKiAgICAgICAgICAgICAvLyBsYWJlbDogU3RyaW5nDQogICAgICogICAgICAgICAgICAgLy8NCiAgICAgKiAgICAgICAgICAgICAvLyBUaGUgJ3ByZXZpb3VzIGl0ZW0nIGxhYmVsLg0KICAgICAqICAgICAgICAgICAgIC8vDQogICAgICogICAgICAgICAgICAgJ2xhYmVsJzogJzwnLA0KICAgICAqICAgICAgICAgICAgIC8vDQogICAgICogICAgICAgICAgICAgLy8gc2VsZWN0b3I6IFN0cmluZw0KICAgICAqICAgICAgICAgICAgIC8vDQogICAgICogICAgICAgICAgICAgLy8gTmF2aWdhdGlvbiAncHJldmlvdXMgaXRlbScgc2VsZWN0b3I7IGlmIGVxdWFscyBudWxsLCB0aGUgaXRlbSB3aWxsIGJlIGdlbmVyYXRlZA0KICAgICAqICAgICAgICAgICAgIC8vICgnYScgZWxlbWVudCB3aXRoICdwcmV2JyBjbGFzcyBhdHRyaWJ1dGUgaW5zaWRlIHRoZSBuYXZpZ2F0aW9uIGNvbnRhaW5lcikuDQogICAgICogICAgICAgICAgICAgLy8NCiAgICAgKiAgICAgICAgICAgICAnc2VsZWN0b3InOiBudWxsLA0KICAgICAqICAgICAgICAgICAgIC8vDQogICAgICogICAgICAgICAgICAgLy8gaXNDb250YWluZXI6IEJvb2xlYW4NCiAgICAgKiAgICAgICAgICAgICAvLw0KICAgICAqICAgICAgICAgICAgIC8vIFNldHMgd2hldGhlciB0aGUgZWxlbWVudCBmb3VuZCBieSBzZWxlY3RvciBzaG91bGQgYmUgdHJlYXRlZCBhcyBhIGNvbnRhaW5lciAoaWYgdHJ1ZSkNCiAgICAgKiAgICAgICAgICAgICAvLyBvciBzaG91bGQgYmUgYWRvcHRlZCBhcyBhICdwcmV2aW91cyBpdGVtJyAoaWYgZmFsc2UpLiBJZiBzZWxlY3RvciBlcXVhbHMgbnVsbCB0aGlzIHByb3BlcnR5IGlzIG1lYW5pbmdsZXNzLg0KICAgICAqICAgICAgICAgICAgIC8vDQogICAgICogICAgICAgICAgICAgJ2lzQ29udGFpbmVyJzogZmFsc2UNCiAgICAgKiAgICAgICAgIH0sDQogICAgICogICAgICAgICAvLw0KICAgICAqICAgICAgICAgLy8gbmV4dEl0ZW06IE9iamVjdA0KICAgICAqICAgICAgICAgLy8NCiAgICAgKiAgICAgICAgIC8vIE5hdmlnYXRpb24gJ25leHQgaXRlbScgY29uZmlndXJhdGlvbiBvYmplY3QuDQogICAgICogICAgICAgICAvLw0KICAgICAqICAgICAgICAgJ25leHRJdGVtJzogew0KICAgICAqICAgICAgICAgICAgIC8vDQogICAgICogICAgICAgICAgICAgLy8gbGFiZWw6IFN0cmluZw0KICAgICAqICAgICAgICAgICAgIC8vDQogICAgICogICAgICAgICAgICAgLy8gVGhlICduZXh0IGl0ZW0nIGxhYmVsLg0KICAgICAqICAgICAgICAgICAgIC8vDQogICAgICogICAgICAgICAgICAgJ2xhYmVsJzogJz4nLA0KICAgICAqICAgICAgICAgICAgIC8vDQogICAgICogICAgICAgICAgICAgLy8gc2VsZWN0b3I6IFN0cmluZw0KICAgICAqICAgICAgICAgICAgIC8vDQogICAgICogICAgICAgICAgICAgLy8gTmF2aWdhdGlvbiAnbmV4dCBpdGVtJyBzZWxlY3RvcjsgaWYgZXF1YWxzIG51bGwsIHRoZSBpdGVtIHdpbGwgYmUgZ2VuZXJhdGVkDQogICAgICogICAgICAgICAgICAgLy8gKCdhJyBlbGVtZW50IHdpdGggJ25leHQnIGNsYXNzIGF0dHJpYnV0ZSBpbnNpZGUgdGhlIG5hdmlnYXRpb24gY29udGFpbmVyKS4NCiAgICAgKiAgICAgICAgICAgICAvLw0KICAgICAqICAgICAgICAgICAgICdzZWxlY3Rvcic6IG51bGwsDQogICAgICogICAgICAgICAgICAgLy8NCiAgICAgKiAgICAgICAgICAgICAvLyBpc0NvbnRhaW5lcjogQm9vbGVhbg0KICAgICAqICAgICAgICAgICAgIC8vDQogICAgICogICAgICAgICAgICAgLy8gU2V0cyB3aGV0aGVyIHRoZSBlbGVtZW50IGZvdW5kIGJ5IHNlbGVjdG9yIHNob3VsZCBiZSB0cmVhdGVkIGFzIGEgY29udGFpbmVyIChpZiB0cnVlKQ0KICAgICAqICAgICAgICAgICAgIC8vIG9yIHNob3VsZCBiZSBhZG9wdGVkIGFzIGEgJ25leHQgaXRlbScgKGlmIGZhbHNlKS4gSWYgc2VsZWN0b3IgZXF1YWxzIG51bGwgdGhpcyBwcm9wZXJ0eSBpcyBtZWFuaW5nbGVzcy4NCiAgICAgKiAgICAgICAgICAgICAvLw0KICAgICAqICAgICAgICAgICAgICdpc0NvbnRhaW5lcic6IGZhbHNlDQogICAgICogICAgICAgICB9DQogICAgICogICAgIH0sDQogICAgICogICAgIC8vDQogICAgICogICAgIC8vIHRpbWVvdXQ6IE51bWJlcg0KICAgICAqICAgICAvLw0KICAgICAqICAgICAvLyBUaGUgaW50ZXJ2YWwgYmV0d2VlbiB0aGUgc2xpZGVzIGluIG1pbGlzZWNvbmRzLg0KICAgICAqICAgICAvLw0KICAgICAqICAgICAndGltZW91dCc6IDEwMDAwLA0KICAgICAqICAgICAvLw0KICAgICAqICAgICAvLyB0cmFuc2l0aW9uOiBTdHJpbmcNCiAgICAgKiAgICAgLy8NCiAgICAgKiAgICAgLy8gTmFtZSBvZiB0aGUgdHJhbnNpdGlvbiBjbGFzcywgd2hpY2ggd2lsbCBiZSB1c2VkLiBQb3NzaWJsZSB2YWx1ZXMgYXJlOg0KICAgICAqICAgICAvLyAtIEJhc2ljVHJhbnNpdGlvbiAtIHdpdGhvdXQgYW55IGFuaW1hdGlvbiwNCiAgICAgKiAgICAgLy8gLSBGYWRlSW5UcmFuc2l0aW9uIC0gbmV3IHNsaWRlIGZhZGVzIGluLA0KICAgICAqICAgICAvLyAtIFNsaWRlSG9yaXpvbnRhbGx5VHJhbnNpdGlvbiAtIG5ldyBzbGlkZSBtb3ZlcyBmcm9tIHJpZ2h0IChmcm9tIGxlZnQgaWYgdXNlciBzZWxlY3RzIHNsaWRlIHdpdGggbG93ZXIgaWQgb3IgY2xpY2tzIG9uICdwcmV2aW91cyBpdGVtJyksDQogICAgICogICAgIC8vIC0gU2xpZGVWZXJ0aWNhbGx5VHJhbnNpdGlvbiAtIG5ldyBzbGlkZSBtb3ZlcyBmcm9tIHRvcCAoZnJvbSBib3R0b20gaWYgdXNlciBzZWxlY3RzIHNsaWRlIHdpdGggbG93ZXIgaWQgb3IgY2xpY2tzIG9uICdwcmV2aW91cyBpdGVtJyksDQogICAgICogICAgIC8vIC0gb3RoZXIgLSBpZiBpbXBsZW1lbnRlZCAoZGVyaXZlZCBmcm9tIFhBLmNvbXBvbmVudC5jYXJvdXNlbHMuVHJhbnNpdGlvbnMuVHJhbnNpdGlvbiBjbGFzcykgYW5kIGFkZGVkIHRvIFhBLmNvbXBvbmVudC5jYXJvdXNlbHMuVHJhbnNpdGlvbnMgbW9kdWxlLg0KICAgICAqICAgICAvLw0KICAgICAqICAgICAndHJhbnNpdGlvbic6ICdCYXNpY1RyYW5zaXRpb24nLA0KICAgICAqICAgICAvLw0KICAgICAqICAgICAvLyBpc1BhdXNlRW5hYmxlZDogQm9vbGVhbg0KICAgICAqICAgICAvLw0KICAgICAqICAgICAvLyBTZXRzIHdoZXRoZXIgdGhlIHBhdXNlIGZlYXR1cmUgaXMgZW5hYmxlZC4NCiAgICAgKiAgICAgLy8gUGF1c2UgZmVhdHVyZSBwYXVzZXMgY291bnRkb3duIG9mIGNoYW5naW5nIHNsaWRlcywgd2hlbiBtb3VzZSBpcyBpbiBhIGNhcm91c2VsIGFyZWEuDQogICAgICogICAgIC8vDQogICAgICogICAgICdpc1BhdXNlRW5hYmxlZCc6IHRydWUsDQogICAgICogICAgIC8vDQogICAgICogICAgIC8vIHRpbWVJbmRpY2F0b3I6IE9iamVjdA0KICAgICAqICAgICAvLw0KICAgICAqICAgICAvLyAnVGltZSBpbmRpY2F0b3InIGNvbmZpZ3VyYXRpb24gb2JqZWN0Lg0KICAgICAqICAgICAvLw0KICAgICAqICAgICAndGltZUluZGljYXRvcic6IHsNCiAgICAgKiAgICAgICAgIC8vDQogICAgICogICAgICAgICAvLyBpc0VuYWJsZWQ6IEJvb2xlYW4NCiAgICAgKiAgICAgICAgIC8vDQogICAgICogICAgICAgICAvLyBTZXRzIHdoZXRoZXIgdGhlICd0aW1lIGluZGljYXRvcicgaXMgZW5hYmxlZC4NCiAgICAgKiAgICAgICAgIC8vDQogICAgICogICAgICAgICAnaXNFbmFibGVkJzogZmFsc2UsDQogICAgICogICAgICAgICAvLw0KICAgICAqICAgICAgICAgLy8gc2VsZWN0b3I6IFN0cmluZw0KICAgICAqICAgICAgICAgLy8NCiAgICAgKiAgICAgICAgIC8vICdUaW1lIGluZGljYXRvcicgc2VsZWN0b3IuDQogICAgICogICAgICAgICAvLw0KICAgICAqICAgICAgICAgJ3NlbGVjdG9yJzogbnVsbCwNCiAgICAgKiAgICAgICAgIC8vDQogICAgICogICAgICAgICAvLyB2aWV3OiBTdHJpbmcNCiAgICAgKiAgICAgICAgIC8vDQogICAgICogICAgICAgICAvLyBOYW1lIG9mIHRoZSB2aWV3IGNsYXNzLCB3aGljaCB3aWxsIGJlIHVzZWQuIFBvc3NpYmxlIHZhbHVlcyBhcmU6DQogICAgICogICAgICAgICAvLyAtIFZpZXcgLSB3aXRob3V0IGFueSBhbmltYXRpb24gKGJhc2UgY2xhc3MpLA0KICAgICAqICAgICAgICAgLy8gLSBQcm9ncmVzc0JhclZpZXcgLSBzaG93cyB0aGUgcHJvZ3Jlc3Mgb2YgdGltZSBhcyBwcm9ncmVzcyBiYXIsDQogICAgICogICAgICAgICAvLyAtIFJvdGF0b3JWaWV3IC0gc2hvd3MgdGhlIHByb2dyZXNzIG9mIHRpbWUgd2l0aCB0aGUgZmlsbGluZyB1cCByaW5nDQogICAgICogICAgICAgICAvLyAtIG90aGVyIC0gaWYgaW1wbGVtZW50ZWQgKGRlcml2ZWQgZnJvbSBYQS5jb21wb25lbnQuY2Fyb3VzZWxzLkluZGljYXRvclZpZXdzLlZpZXcgY2xhc3MpIGFuZCBhZGRlZCB0byBYQS5jb21wb25lbnQuY2Fyb3VzZWxzLkluZGljYXRvclZpZXdzIG1vZHVsZS4NCiAgICAgKiAgICAgICAgIC8vDQogICAgICogICAgICAgICAndmlldyc6ICdWaWV3JywNCiAgICAgKiAgICAgICAgIC8vDQogICAgICogICAgICAgICAvLyBvcHRpb25zOiBPYmplY3QNCiAgICAgKiAgICAgICAgIC8vDQogICAgICogICAgICAgICAvLyAnVGltZSBpbmRpY2F0b3InIHZpZXcgc2V0dGluZ3Mgb2JqZWN0LiBEZXBlbmRzIG9uIHZpZXcuDQogICAgICogICAgICAgICAvLw0KICAgICAqICAgICAgICAgJ29wdGlvbnMnOiB7fQ0KICAgICAqICAgICB9DQogICAgICogfQ0KICAgICAqLw0KDQogICAgLyogcHViLnJlZ2lzdGVyID0gZnVuY3Rpb24gKHNlbGVjdG9yLCBvcHRpb25zKSB7DQogICAgIHZhciAkY2Fyb3VzZWxzID0gJChzZWxlY3Rvcik7DQogICAgICRjYXJvdXNlbHMuZWFjaChmdW5jdGlvbiAoKSB7DQogICAgIC8vdmFyIGNhcm91c2VsID0gbmV3IENhcm91c2VsKCQpOw0KICAgICBjb25zb2xlLmxvZygkKHRoaXMpKTsNCiAgICAgLy9jYXJvdXNlbC5pbml0KCQodGhpcyksIG9wdGlvbnMpOw0KICAgICB9KTsNCiAgICAgfTsqLw0KDQogICAgQ2Fyb3VzZWwucHJvdG90eXBlLmFkZFJlc3BvbnNpdmUgPSBmdW5jdGlvbihjYXJvdXNlbCkgew0KICAgICAgICBmdW5jdGlvbiBzZXRDYXJvdXNlbFNpemUoKSB7DQogICAgICAgICAgICBjYXJvdXNlbC5jc3MoIndpZHRoIiwgIjEwMCUiKTsNCiAgICAgICAgICAgIGNhcm91c2VsLmNzcygiaGVpZ2h0IiwgImF1dG8iKTsNCiAgICAgICAgICAgIGNhcm91c2VsLmZpbmQoIi53cmFwcGVyICwgLnNsaWRlIikuY3NzKCJoZWlnaHQiLCAiYXV0byIpOw0KDQogICAgICAgICAgICB2YXIgY2Fyb3VzZWxXaWR0aCA9IGNhcm91c2VsLndpZHRoKCksDQogICAgICAgICAgICAgICAgc2xpZGVzID0gY2Fyb3VzZWwuZmluZCgnLnNsaWRlJyksDQogICAgICAgICAgICAgICAgc2xpZGVNYXhIZWlnaHQgPSAwOw0KDQoNCiAgICAgICAgICAgIF8uZWFjaChzbGlkZXMsIGZ1bmN0aW9uKGl0ZW0pIHsNCiAgICAgICAgICAgICAgICB2YXIgc2xpZGVIZWlnaHQgPSAkKGl0ZW0pLm91dGVySGVpZ2h0KCk7DQoNCiAgICAgICAgICAgICAgICBpZiAoc2xpZGVNYXhIZWlnaHQgPCBzbGlkZUhlaWdodCkgew0KICAgICAgICAgICAgICAgICAgICBzbGlkZU1heEhlaWdodCA9IHNsaWRlSGVpZ2h0Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICBjYXJvdXNlbC5maW5kKCIuc2xpZGUsIC5zbGlkZXMiKS5jc3MoIndpZHRoIiwgY2Fyb3VzZWxXaWR0aCk7DQogICAgICAgICAgICBjYXJvdXNlbC5maW5kKCIud3JhcHBlciIpLmNzcygiaGVpZ2h0Iiwgc2xpZGVNYXhIZWlnaHQpOw0KICAgICAgICAgICAgY2Fyb3VzZWwuZmluZCgiLnNsaWRlIikuY3NzKCJoZWlnaHQiLCBzbGlkZU1heEhlaWdodCk7DQogICAgICAgIH0NCg0KICAgICAgICBzZXRDYXJvdXNlbFNpemUoKTsNCiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgc2V0Q2Fyb3VzZWxTaXplKCk7DQogICAgICAgIH0pOw0KICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgc2V0Q2Fyb3VzZWxTaXplKCk7DQoJCQljYXJvdXNlbC5hZGRDbGFzcygiY2Fyb3VzZWwtcmVhZHkiKTsNCiAgICAgICAgfSk7DQogICAgfTsNCg0KICAgIC8qIENhcm91c2VsIHRvdWNoIHN1cHBvcnQgKi8NCiAgICBDYXJvdXNlbC5wcm90b3R5cGUuc3dpcGVTbGlkZSA9IGZ1bmN0aW9uIChlKSB7DQogICAgICAgIHZhciBzZWxmID0gdGhpcywNCiAgICAgICAgICAgICR3cmFwcGVyID0gdGhpcy5zbGlkZXIuY29udGV4dC4kd3JhcHBlciwNCiAgICAgICAgICAgIGhhbW1lciA9IG5ldyBIYW1tZXIoJHdyYXBwZXJbMF0pOw0KDQogICAgICAgIGhhbW1lci5vbigic3dpcGVsZWZ0IiwgZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgc2VsZi5zbGlkZXIuY29udGV4dC5vd25lci5vbkNoYW5nZUN1cnJlbnRTbGlkZShlLCAxLCBzZWxmLnNsaWRlci5jb250ZXh0KTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgaGFtbWVyLm9uKCJzd2lwZXJpZ2h0IiwgZnVuY3Rpb24oZSkgew0KICAgICAgICAgICAgc2VsZi5zbGlkZXIuY29udGV4dC5vd25lci5vbkNoYW5nZUN1cnJlbnRTbGlkZShlLCAtMSwgc2VsZi5zbGlkZXIuY29udGV4dCk7DQogICAgICAgIH0pOw0KICAgIH07DQoNCiAgICBDYXJvdXNlbC5wcm90b3R5cGUuY2hlY2tGb3JEaXNhYmxlciA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdmFyIHNsaWRlcyA9IHRoaXMuJHNsaWRlczsNCiAgICAgICAgJHdyYXBwZXIgPSB0aGlzLnNsaWRlci5jb250ZXh0LiR3cmFwcGVyOw0KICAgICAgICBfLmVhY2goc2xpZGVzLCBmdW5jdGlvbihpdGVtKSB7DQogICAgICAgICAgICB2YXIgJGl0ZW0gPSAkKGl0ZW0pLA0KICAgICAgICAgICAgICAgIGNwZGlzYWJsZWQgPSAkaXRlbS5maW5kKCcuY3BkaXNhYmxlcicpLA0KICAgICAgICAgICAgICAgICRpdGVtQm9yZGVyID0gcGFyc2VJbnQoJChpdGVtKS5jc3MoJ2JvcmRlcicpLCAxMCkgPyBwYXJzZUludCgkKGl0ZW0pLmNzcygnYm9yZGVyJyksIDEwKSAgOiAxMDsNCg0KICAgICAgICAgICAgaWYgKGNwZGlzYWJsZWQuc2libGluZ3MoJy5jb21wb25lbnQnKS5sZW5ndGggPCAxKSB7DQogICAgICAgICAgICAgICAgJHdyYXBwZXIuY3NzKHsNCiAgICAgICAgICAgICAgICAgICAgJ21pbi1oZWlnaHQnIDogMjUNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgIGNwZGlzYWJsZWQudGV4dCgiRWRpdCBlbGVtZW50IGhlcmUiKTsNCiAgICAgICAgICAgICAgICBjcGRpc2FibGVkLnBhcmVudCgpLmNzcyh7DQogICAgICAgICAgICAgICAgICAgICd3aWR0aCcgOiAkaXRlbS53aWR0aCgpIC0gJGl0ZW1Cb3JkZXIsDQogICAgICAgICAgICAgICAgICAgICdtaW4taGVpZ2h0JyA6IDI1LA0KICAgICAgICAgICAgICAgICAgICAnaGVpZ2h0JyA6ICRpdGVtLmhlaWdodCgpDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0NCg0KDQogICAgQ2Fyb3VzZWwucHJvdG90eXBlLnJlc2l6ZVdyYXBwZXIgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgdmFyIHBhZ2VIZWlnaHQgPSAkKGRvY3VtZW50KS5vdXRlckhlaWdodCgpLA0KICAgICAgICAgICAgaGVhZGVySGVpZ2h0ID0gJCgnI2hlYWRlcicpLm91dGVySGVpZ2h0KCksDQogICAgICAgICAgICBjb250ZW50UGFkZGluZ1RvcCA9IHBhcnNlSW50KCQoJyNjb250ZW50JykuY3NzKCdwYWRkaW5nLXRvcCcpLCAxMCksDQogICAgICAgICAgICBjb250ZW50UGFkZGluZ0JvdHRvbSA9IHBhcnNlSW50KCQoJyNjb250ZW50JykuY3NzKCdwYWRkaW5nLWJvdHRvbScpLCAxMCksDQogICAgICAgICAgICBjb250ZW50UGFkZGluZyA9IGNvbnRlbnRQYWRkaW5nVG9wICsgY29udGVudFBhZGRpbmdCb3R0b20sDQogICAgICAgICAgICBmb290ZXJIZWlnaHQgPSAkKCcjZm9vdGVyJykub3V0ZXJIZWlnaHQoKSwNCiAgICAgICAgICAgIHdyYXBwZXIgPSB0aGlzLnNsaWRlci5jb250ZXh0LiR3cmFwcGVyLA0KICAgICAgICAgICAgY2Fyb3VzZWxIZWlnaHQgPSAwOw0KDQogICAgICAgIGNhcm91c2VsSGVpZ2h0ID0gcGFnZUhlaWdodCAtIChoZWFkZXJIZWlnaHQgKyBmb290ZXJIZWlnaHQgKyBjb250ZW50UGFkZGluZyk7DQoNCiAgICAgICAgd3JhcHBlci5jc3Moew0KICAgICAgICAgICAgJ2hlaWdodCc6IGNhcm91c2VsSGVpZ2h0DQogICAgICAgIH0pOw0KDQogICAgICAgIHdyYXBwZXIuZmluZCgnLnNsaWRlcycpLmNzcyh7DQogICAgICAgICAgICAnaGVpZ2h0JzogY2Fyb3VzZWxIZWlnaHQNCiAgICAgICAgfSk7DQogICAgfTsNCg0KDQoNCiAgICBwdWIuaW5pdCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAkKCIuY2Fyb3VzZWw6bm90KC5pbml0aWFsaXplZCkiKS5lYWNoKGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIHByb3BlcnRpZXMgPSAkKHRoaXMpLmRhdGEoImRhdGEtcHJvcGVydGllcyIpLA0KICAgICAgICAgICAgICAgIGNvbXBvbmVudCA9ICQodGhpcykuZmluZCgiLmNhcm91c2VsLWlubmVyIiksDQogICAgICAgICAgICAgICAgaWQgPSBjb21wb25lbnQuYXR0cigiaWQiKTsNCg0KICAgICAgICAgICAgaWYgKHByb3BlcnRpZXMpIHsNCiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLm5hdmlnYXRpb24uaXRlbS5zZWxlY3RvciA9ICIjIiArIHByb3BlcnRpZXMubmF2aWdhdGlvbi5pdGVtLnNlbGVjdG9yOw0KICAgICAgICAgICAgICAgIHByb3BlcnRpZXMubmF2aWdhdGlvbi5wcmV2SXRlbS5zZWxlY3RvciA9ICIjIiArIGlkICsgIiAubmF2IjsNCiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzLm5hdmlnYXRpb24ubmV4dEl0ZW0uc2VsZWN0b3IgPSAiIyIgKyBpZCArICIgLm5hdiI7DQoNCiAgICAgICAgICAgICAgICB2YXIgY2Fyb3VzZWwgPSBuZXcgQ2Fyb3VzZWwoJCk7DQogICAgICAgICAgICAgICAgY2Fyb3VzZWwuaW5pdChjb21wb25lbnQsIHByb3BlcnRpZXMpOw0KICAgICAgICAgICAgICAgIGNhcm91c2VsLmFkZFJlc3BvbnNpdmUoJCh0aGlzKSk7DQoNCiAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYoJChzZWxmKS5oYXNDbGFzcygnY2Fyb3VzZWwtY2xpZW50cycpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBjYXJvdXNlbC5yZXNpemVXcmFwcGVyKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBjYXJvdXNlbC5jaGVja0ZvckRpc2FibGVyKCk7DQogICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICBjYXJvdXNlbC5zd2lwZVNsaWRlKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoImluaXRpYWxpemVkIik7DQogICAgICAgIH0pOw0KICAgIH07DQoNCiAgICByZXR1cm4gcHViOw0KfShqUXVlcnkpKTsNCi8qKg0KICogZW5kIG9mIFhBLmNvbXBvbmVudC5jYXJvdXNlbHMgbW9kdWxlLg0KICovDQoNCg0KWEEucmVnaXN0ZXIoImNhcm91c2VscyIsIFhBLmNvbXBvbmVudC5jYXJvdXNlbHMpOw0KDQoNCi8qKg0KICogQ29nbmlmaWRlDQogKg0KICogWEEuY29tcG9uZW50LmNhcm91c2Vscy5UcmFuc2l0aW9ucyBtb2R1bGUuDQogKg0KICogRXhwb3NlcyBUcmFuc2l0aW9uIGNsYXNzLCB3aGljaCBpcyBiYXNlIGNsYXNzIG9mIGFsbCB0cmFuc2l0aW9ucyB1c2VkIGJ5IGNhcm91c2VscyAoQHNlZSBYQS5jb21wb25lbnQuY2Fyb3VzZWxzLCBAc2VlIFNsaWRlciwgQHNlZSBUcmFuc2l0aW9uKS4NCiAqIEFsc28gZXhwb3NlcyBpbXBsZW1lbnRhdGlvbiBvZiBiYXNpYyBlZmZlY3RzOg0KICogLSBCYXNpY1RyYW5zaXRpb24gLSB3aXRob3V0IGFueSBhbmltYXRpb24sDQogKiAtIEZhZGVJblRyYW5zaXRpb24gLSBuZXcgc2xpZGUgZmFkZXMgaW4sDQogKiAtIFNsaWRlSG9yaXpvbnRhbGx5VHJhbnNpdGlvbiAtIG5ldyBzbGlkZSBtb3ZlcyBmcm9tIHJpZ2h0IChmcm9tIGxlZnQgaWYgdXNlciBzZWxlY3RzIHNsaWRlIHdpdGggbG93ZXIgaWQgb3IgY2xpY2tzIG9uICdwcmV2aW91cyBpdGVtJyksDQogKiAtIFNsaWRlVmVydGljYWxseVRyYW5zaXRpb24gLSBuZXcgc2xpZGUgbW92ZXMgZnJvbSB0b3AgKGZyb20gYm90dG9tIGlmIHVzZXIgc2VsZWN0cyBzbGlkZSB3aXRoIGxvd2VyIGlkIG9yIGNsaWNrcyBvbiAncHJldmlvdXMgaXRlbScpLg0KICogQ2Fyb3VzZWwgdGFrZXMgdGhlIGNsYXNzIGNvbnN0cnVjdG9yIGJ5IG5hbWUgZnJvbSB0aGlzIG1vZHVsZSAoaXQgaXMgZ2l2ZW4gaW4gb3B0aW9ucyBvYmplY3Qgb2YgY2Fyb3VzZWw7IEBzZWUgWEEuY29tcG9uZW50LmNhcm91c2VscykuDQogKiBJZiB0aGVyZSBpcyBhIG5lZWQgdG8gaW1wbGVtZW50IHRoZSBuZXcgZWZmZWN0LCBjcmVhdGUgYSBuZXcgY2xhc3MsIGJ5IGluaGVyaXRpbmcgZnJvbSBUcmFuc2l0aW9uIGNsYXNzIGFuZCBhZGQgaXQgdG8gdGhpcyBtb2R1bGUuDQogKg0KICogRXhhbXBsZSBlZmZlY3QgaW1wbGVtZW50YXRpb24gKGN1cnJlbnRseSBkaXNwbGF5ZWQgc2xpZGUgaXMgc2hyaW5raW5nIHRvIGNlbnRlciBvZiB0aGUgY2Fyb3VzZWwpOg0KICogKGZ1bmN0aW9uICgpIHsNCiogICAgIGZ1bmN0aW9uIFNhbXBsZVRyYW5zaXRpb24oKSB7IH0NCioNCiogICAgIC8vaW5oZXJpdCBmcm9tIFhBLmNvbXBvbmVudC5jYXJvdXNlbHMuVHJhbnNpdGlvbnMuVHJhbnNpdGlvbg0KKiAgICAgU2FtcGxlVHJhbnNpdGlvbi5wcm90b3R5cGUgPSBuZXcgWEEuY29tcG9uZW50LmNhcm91c2Vscy5UcmFuc2l0aW9ucy5UcmFuc2l0aW9uKCk7DQoqICAgICBTYW1wbGVUcmFuc2l0aW9uLmNvbnN0cnVjdG9yID0gU2FtcGxlVHJhbnNpdGlvbjsNCioNCiogICAgIFNhbXBsZVRyYW5zaXRpb24ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoc2V0dGluZ3MpIHsNCiogICAgICAgICAvL3Bvc2l0aW9uaW5nIGFsbCBzbGlkZXMgaW4gdGhlIHRvcCBsZWZ0IGNvcm5lciBvZiB0aGUgY2Fyb3VzZWwNCiogICAgICAgICBzZXR0aW5ncy4kc2xpZGVzLmNzcyh7DQoqICAgICAgICAgICAgICdwb3NpdGlvbic6ICdhYnNvbHV0ZScsDQoqICAgICAgICAgICAgICd0b3AnOiAnMHB4JywNCiogICAgICAgICAgICAgJ2xlZnQnOiAnMHB4Jw0KKiAgICAgICAgIH0pOw0KKiAgICAgfTsNCioNCiogICAgIFNhbXBsZVRyYW5zaXRpb24ucHJvdG90eXBlLm9uQW5pbWF0aW9uQ29tcGxldGUgPSBmdW5jdGlvbihzZXR0aW5ncywgd2lkdGgsIGhlaWdodCkgew0KKiAgICAgICAgIHZhciB6SW5kZXhBdHRyaWIgPSAnei1pbmRleCcsDQoqICAgICAgICAgJGN1cnJlbnQgPSBzZXR0aW5ncy4kY3VycmVudFNsaWRlOw0KKg0KKiAgICAgICAgICRjdXJyZW50LmhpZGUoKTsNCiAgICAgICAgICAvL3JldmVydGluZyBjaGFuZ2VzIGluIGNzcyBwcm9wZXJ0aWVzDQoqICAgICAgICAgJGN1cnJlbnQuY3NzKHsNCiogICAgICAgICAgICAgJ3dpZHRoJzogd2lkdGgsDQoqICAgICAgICAgICAgICdoZWlnaHQnOiBoZWlnaHQsDQoqICAgICAgICAgICAgICdsZWZ0JzogMCwNCiogICAgICAgICAgICAgJ3RvcCc6IDANCiogICAgICAgICB9KTsNCiogICAgICAgICAkY3VycmVudC5jc3MoekluZGV4QXR0cmliLCAnJyk7DQoqICAgICAgICAgc2V0dGluZ3MuJHNsaWRlcy5wYXJlbnQoKS5jc3MoekluZGV4QXR0cmliLCAnJyk7DQoqDQoqICAgICAgICAgLy9ub3RpZnlpbmcgdGhlIGNhcm91c2VsLCB0aGF0IGFuaW1hdGlvbiBpcyBjb21wbGV0ZWQNCiogICAgICAgICBzZXR0aW5ncy5jYWxsYmFjaygpOw0KKiAgICAgfTsNCioNCiogICAgIFNhbXBsZVRyYW5zaXRpb24ucHJvdG90eXBlLnBlcmZvcm0gPSBmdW5jdGlvbiAoc2V0dGluZ3MpIHsNCiogICAgICAgICB2YXIgaGVpZ2h0ID0gc2V0dGluZ3MuJGN1cnJlbnRTbGlkZS5oZWlnaHQoKSwNCiogICAgICAgICB3aWR0aCA9IHNldHRpbmdzLiRjdXJyZW50U2xpZGUud2lkdGgoKSwNCiogICAgICAgICBvbkFuaW1hdGlvbkNvbXBsZXRlZCA9IHRoaXMub25BbmltYXRpb25Db21wbGV0ZSwNCiogICAgICAgICB6SW5kZXhBdHRyaWIgPSAnei1pbmRleCcsDQoqICAgICAgICAgJHBhcmVudCA9IHNldHRpbmdzLiRzbGlkZXMucGFyZW50KCksDQoqICAgICAgICAgJGN1cnJlbnQgPSBzZXR0aW5ncy4kY3VycmVudFNsaWRlLA0KKiAgICAgICAgICRuZXh0ID0gc2V0dGluZ3MuJG5leHRTbGlkZTsNCioNCiogICAgICAgICAvL3NldHRpbmcgYSBuZXcgc2xpZGUgdW5kZXIgdGhlIGN1cnJlbnQgc2xpZGUNCiogICAgICAgICAkcGFyZW50LmNzcyh6SW5kZXhBdHRyaWIsIDApOw0KKiAgICAgICAgICRjdXJyZW50LmNzcyh6SW5kZXhBdHRyaWIsIDEpOw0KKiAgICAgICAgICRuZXh0LnNob3coKTsNCioNCiogICAgICAgICAvL2FuaW1hdGUgY3VycmVudCBzbGlkZQ0KKiAgICAgICAgICRjdXJyZW50LmFuaW1hdGUoew0KKiAgICAgICAgICAgICAnd2lkdGgnOiAnMHB4JywNCiogICAgICAgICAgICAgJ2hlaWdodCc6ICcwcHgnLA0KKiAgICAgICAgICAgICAnbGVmdCc6IHdpZHRoIC8gMiwNCiogICAgICAgICAgICAgJ3RvcCc6IGhlaWdodCAvIDINCiogICAgICAgICB9LCBmdW5jdGlvbigpIHsNCiogICAgICAgICAgICAgb25BbmltYXRpb25Db21wbGV0ZWQoc2V0dGluZ3MsIHdpZHRoLCBoZWlnaHQpOw0KKiAgICAgICAgIH0pOw0KKiAgICAgfTsNCioNCiogICAgIC8vYWRkaW5nIG5ldyBlZmZlY3QgdG8gWEEuY29tcG9uZW50LmNhcm91c2Vscy5UcmFuc2l0aW9ucyBtb2R1bGUuDQoqICAgICBYQS5jb21wb25lbnQuY2Fyb3VzZWxzLlRyYW5zaXRpb25zLlNhbXBsZVRyYW5zaXRpb24gPSBTYW1wbGVUcmFuc2l0aW9uOw0KKiB9ICgpKTsNCiAqDQogKi8NClhBLmNvbXBvbmVudC5jYXJvdXNlbHMuVHJhbnNpdGlvbnMgPSAoZnVuY3Rpb24oJCkgew0KICAgIHZhciBwdWIgPSB7fTsNCg0KICAgIC8qKg0KICAgICAqIFRyYW5zaXRpb25TZXR0aW5ncyBjbGFzcyBob2xkcyBkYXRhIG5lZWRlZCBmb3IgY2hhbmdpbmcgc2xpZGVzDQogICAgICogQGNvbnN0cnVjdG9yDQogICAgICovDQogICAgZnVuY3Rpb24gVHJhbnNpdGlvblNldHRpbmdzKCkge30NCiAgICAvKioNCiAgICAgKiBDdXJyZW50IHNsaWRlIChjdXJyZW50bHkgZGlzcGxheWVkKSBqUXVlcnkgb2JqZWN0DQogICAgICoNCiAgICAgKiBAbWVtYmVyIFRyYW5zaXRpb25TZXR0aW5ncw0KICAgICAqLw0KICAgIFRyYW5zaXRpb25TZXR0aW5ncy5wcm90b3R5cGUuJGN1cnJlbnRTbGlkZSA9IG51bGw7DQogICAgLyoqDQogICAgICogTmV4dCBzbGlkZSBqUXVlcnkgb2JqZWN0DQogICAgICoNCiAgICAgKiBAbWVtYmVyIFRyYW5zaXRpb25TZXR0aW5ncw0KICAgICAqLw0KICAgIFRyYW5zaXRpb25TZXR0aW5ncy5wcm90b3R5cGUuJG5leHRTbGlkZSA9IG51bGw7DQogICAgLyoqDQogICAgICogQWxsIHNsaWRlcyAoalF1ZXJ5IG9iamVjdCkNCiAgICAgKg0KICAgICAqIEBtZW1iZXIgVHJhbnNpdGlvblNldHRpbmdzDQogICAgICovDQogICAgVHJhbnNpdGlvblNldHRpbmdzLnByb3RvdHlwZS4kc2xpZGVzID0gbnVsbDsNCiAgICAvKioNCiAgICAgKiBPZmZzZXQgYmV0d2VlbiAkY3VycmVudFNsaWRlIGFuZCAkbmV4dFNsaWRlDQogICAgICoNCiAgICAgKiBAbWVtYmVyIFRyYW5zaXRpb25TZXR0aW5ncw0KICAgICAqLw0KICAgIFRyYW5zaXRpb25TZXR0aW5ncy5wcm90b3R5cGUub2Zmc2V0ID0gMDsNCiAgICAvKioNCiAgICAgKiBDYWxsYmFjayBmdW5jdGlvbiB3aGljaCBtdXN0IGJlIGNhbGxlZCBhZnRlciBhbmltYXRpb24uDQogICAgICoNCiAgICAgKiBAbWVtYmVyIFRyYW5zaXRpb25TZXR0aW5ncw0KICAgICAqLw0KICAgIFRyYW5zaXRpb25TZXR0aW5ncy5wcm90b3R5cGUuY2FsbGJhY2sgPSBudWxsOw0KICAgIC8qKg0KICAgICAqIGVuZCBvZiBUcmFuc2l0aW9uU2V0dGluZ3MgY2xhc3MNCiAgICAgKi8NCiAgICBwdWIuVHJhbnNpdGlvblNldHRpbmdzID0gVHJhbnNpdGlvblNldHRpbmdzOw0KDQogICAgLyoqDQogICAgICogVHJhbnNpdGlvbiBjbGFzcyBpcyBhIGJhc2UgY2xhc3Mgb2YgYWxsIHRyYW5zaXRpb25zLg0KICAgICAqDQogICAgICogSW1wb3J0YW50OiBzZXR0aW5ncy5jYWxsYmFjaygpIChAc2VlIFRyYW5zaXRpb25TZXR0aW5ncykgaGF2ZSB0byBiZSBjYWxsZWQgYXQgdGhlIGVuZCBvZiBleGVjdXRpb24gdGhlIHBlcmZvcm0oKSBtZXRob2QuDQogICAgICoNCiAgICAgKiBAY29uc3RydWN0b3INCiAgICAgKi8NCiAgICBmdW5jdGlvbiBUcmFuc2l0aW9uKCkge30NCiAgICBUcmFuc2l0aW9uLnByb3RvdHlwZSA9IG5ldyBUcmFuc2l0aW9uKCk7DQogICAgLyoqDQogICAgICogSW5pdGlhbGl6ZXMgYSB0cmFuc2l0aW9uIHdpdGggZ2l2ZW4gc2V0dGluZ3MgKEBzZWUgVHJhbnNpdGlvblNldHRpbmdzKS4NCiAgICAgKg0KICAgICAqIEBtZW1iZXIgVHJhbnNpdGlvbg0KICAgICAqIEBwYXJhbSB7VHJhbnNpdGlvblNldHRpbmdzfSBzZXR0aW5ncyAgdHJhbnNpdGlvbiBzZXR0aW5ncw0KICAgICAqLw0KICAgIFRyYW5zaXRpb24ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbihzZXR0aW5ncykge307DQogICAgLyoqDQogICAgICogUmV0dXJucyBhIGZhY3RvciBhc3NvY2lhdGVkIHdpdGggc2V0dGluZ3Mub2Zmc2V0IChAc2VlIFRyYW5zaXRpb25TZXR0aW5ncyksIHdoaWNoDQogICAgICogY2FuIGJlIHVzZWZ1bGwgZm9yIHNvbWUgYW5pbWF0aW9ucy4NCiAgICAgKg0KICAgICAqIEBtZW1iZXIgVHJhbnNpdGlvbg0KICAgICAqIEBwYXJhbSB7VHJhbnNpdGlvblNldHRpbmdzfSBzZXR0aW5ncyAgdHJhbnNpdGlvbiBzZXR0aW5ncw0KICAgICAqIEByZXR1cm4gVGhlIGZhY3RvcjsgMSBpZiBvZmZzZXQgaXMgaGlnaGVyIHRoYW4gMCwgLTEgb3RoZXJ3aXNlDQogICAgICogQHR5cGUgTnVtYmVyDQogICAgICovDQogICAgVHJhbnNpdGlvbi5wcm90b3R5cGUuZmFjdG9yID0gZnVuY3Rpb24oc2V0dGluZ3MpIHsNCiAgICAgICAgcmV0dXJuIChzZXR0aW5ncy5vZmZzZXQgPiAwKSA/IDEgOiAtMTsNCiAgICB9Ow0KICAgIC8qKg0KICAgICAqIFRoaXMgbWV0aG9kIGlzIGNhbGxlZCB1c2VkIGJ5IGNhcm91c2VscyB0byBjaGFuZ2Ugc2xpZGVzLg0KICAgICAqDQogICAgICogSW1wb3J0YW50OiBzZXR0aW5ncy5jYWxsYmFjaygpIChAc2VlIFRyYW5zaXRpb25TZXR0aW5ncykgaGF2ZSB0byBiZSBjYWxsZWQgYXQgdGhlIGVuZCBvZiB0aGlzIG1ldGhvZCBleGVjdXRpb24uDQogICAgICoNCiAgICAgKiBAbWVtYmVyIFRyYW5zaXRpb24NCiAgICAgKiBAcGFyYW0ge1RyYW5zaXRpb25TZXR0aW5nc30gc2V0dGluZ3MgIHRyYW5zaXRpb24gc2V0dGluZ3MNCiAgICAgKi8NCiAgICBUcmFuc2l0aW9uLnByb3RvdHlwZS5wZXJmb3JtID0gZnVuY3Rpb24oc2V0dGluZ3MpIHsNCiAgICAgICAgc2V0dGluZ3MuY2FsbGJhY2soKTsNCiAgICB9Ow0KICAgIC8qKg0KICAgICAqIEVuZCBvZiBUcmFuc2l0aW9uIGNsYXNzDQogICAgICovDQogICAgcHViLlRyYW5zaXRpb24gPSBUcmFuc2l0aW9uOw0KDQogICAgLyoqDQogICAgICogQmFzaWNUcmFuc2l0aW9uIGNsYXNzIGNoYW5nZXMgc2xpZGVzIHdpdGhvdXQgYW55IGFuaW1hdGlvbi4NCiAgICAgKiBEbyBub3QgcmVtb3ZlIHRoaXMgY2xhc3MsIGJlY2FvdXNlIGNhcm91c2VscyB3aWxsIHVzZSBpdCBieSBkZWZhdWx0LA0KICAgICAqIGlmIHJlcXVlc3RlZCB0cmFuc2l0aW9uIGNhbm5vdCBiZSBmb3VuZC4NCiAgICAgKiBAY29uc3RydWN0b3INCiAgICAgKi8NCiAgICBmdW5jdGlvbiBCYXNpY1RyYW5zaXRpb24oKSB7fQ0KICAgIEJhc2ljVHJhbnNpdGlvbi5wcm90b3R5cGUgPSBuZXcgVHJhbnNpdGlvbigpOw0KICAgIEJhc2ljVHJhbnNpdGlvbi5jb25zdHJ1Y3RvciA9IEJhc2ljVHJhbnNpdGlvbjsNCiAgICAvKioNCiAgICAgKiBAbWVtYmVyIEJhc2ljVHJhbnNpdGlvbg0KICAgICAqLw0KICAgIEJhc2ljVHJhbnNpdGlvbi5wcm90b3R5cGUucGVyZm9ybSA9IGZ1bmN0aW9uKHNldHRpbmdzKSB7DQogICAgICAgIHNldHRpbmdzLiRjdXJyZW50U2xpZGUuaGlkZSgpOw0KICAgICAgICBzZXR0aW5ncy4kbmV4dFNsaWRlLnNob3coKTsNCg0KICAgICAgICBzZXR0aW5ncy5jYWxsYmFjaygpOw0KICAgIH07DQogICAgLyoqDQogICAgICogRW5kIG9mIEJhc2ljVHJhbnNpdGlvbiBjbGFzcw0KICAgICAqLw0KICAgIHB1Yi5CYXNpY1RyYW5zaXRpb24gPSBCYXNpY1RyYW5zaXRpb247DQoNCiAgICAvKioNCiAgICAgKiBGYWRlSW5UcmFuc2l0aW9uIGNsYXNzIGNoYW5nZXMgc2xpZGVzIGJ5IGZhZGluZyBpbiBuZXcgc2xpZGUuDQogICAgICogVGhpcyBjbGFzcyBjYW4gYmUgcmVtb3ZlZCBpZiBlZmZlY3QgaXMgbm90IHVzZWQuDQogICAgICogQGNvbnN0cnVjdG9yDQogICAgICovDQogICAgZnVuY3Rpb24gRmFkZUluVHJhbnNpdGlvbigpIHt9DQogICAgRmFkZUluVHJhbnNpdGlvbi5wcm90b3R5cGUgPSBuZXcgVHJhbnNpdGlvbigpOw0KICAgIEZhZGVJblRyYW5zaXRpb24uY29uc3RydWN0b3IgPSBGYWRlSW5UcmFuc2l0aW9uOw0KICAgIC8qKg0KICAgICAqIEBtZW1iZXIgRmFkZUluVHJhbnNpdGlvbg0KICAgICAqLw0KICAgIEZhZGVJblRyYW5zaXRpb24ucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbihzZXR0aW5ncykgew0KICAgICAgICAvKnNldHRpbmdzLiRzbGlkZXMuY3NzKHsNCiAgICAgICAgICdwb3NpdGlvbic6ICdhYnNvbHV0ZScsDQogICAgICAgICAndG9wJzogJzBweCcsDQogICAgICAgICAnbGVmdCc6ICcwcHgnDQogICAgICAgICB9KTsqLw0KICAgIH07DQogICAgLyoqDQogICAgICogQG1lbWJlciBGYWRlSW5UcmFuc2l0aW9uDQogICAgICovDQogICAgRmFkZUluVHJhbnNpdGlvbi5wcm90b3R5cGUucGVyZm9ybSA9IGZ1bmN0aW9uKHNldHRpbmdzKSB7DQogICAgICAgIHZhciB6SW5kZXhBdHRyaWIgPSAnei1pbmRleCcsDQogICAgICAgICAgICAkcGFyZW50ID0gc2V0dGluZ3MuJHNsaWRlcy5wYXJlbnQoKSwNCiAgICAgICAgICAgICRuZXh0U2xpZGUgPSBzZXR0aW5ncy4kbmV4dFNsaWRlOw0KDQogICAgICAgICRwYXJlbnQuY3NzKHpJbmRleEF0dHJpYiwgMCk7DQogICAgICAgICRuZXh0U2xpZGUuY3NzKHpJbmRleEF0dHJpYiwgMSk7DQogICAgICAgIHNldHRpbmdzLiRzbGlkZXMuY3NzKHsNCiAgICAgICAgICAgICdwb3NpdGlvbic6ICdyZWxhdGl2ZScNCiAgICAgICAgfSk7DQoNCiAgICAgICAgc2V0dGluZ3MuJG5leHRTbGlkZS5jc3Moew0KICAgICAgICAgICAgJ3Bvc2l0aW9uJzogJ2Fic29sdXRlJywNCiAgICAgICAgICAgICd0b3AnOiAnMHB4JywNCiAgICAgICAgICAgICdsZWZ0JzogJzBweCcNCiAgICAgICAgfSk7DQoNCg0KICAgICAgICAkbmV4dFNsaWRlLmZhZGVJbihmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHNldHRpbmdzLiRjdXJyZW50U2xpZGUuaGlkZSgpOw0KDQogICAgICAgICAgICBzZXR0aW5ncy4kbmV4dFNsaWRlLmNzcyh7DQogICAgICAgICAgICAgICAgJ3Bvc2l0aW9uJzogJ3JlbGF0aXZlJw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICRuZXh0U2xpZGUuY3NzKHpJbmRleEF0dHJpYiwgJycpOw0KICAgICAgICAgICAgJHBhcmVudC5jc3MoekluZGV4QXR0cmliLCAnJyk7DQoNCiAgICAgICAgICAgIHNldHRpbmdzLmNhbGxiYWNrKCk7DQogICAgICAgIH0pOw0KICAgIH07DQogICAgLyoqDQogICAgICogRW5kIG9mIEZhZGVJblRyYW5zaXRpb24gY2xhc3MNCiAgICAgKi8NCiAgICBwdWIuRmFkZUluVHJhbnNpdGlvbiA9IEZhZGVJblRyYW5zaXRpb247DQoNCiAgICAvKioNCiAgICAgKiBTbGlkZUhvcml6b250YWxseVRyYW5zaXRpb24gY2xhc3MgY2hhbmdlcyBzbGlkZXMgYnkgc2xpZGluZyB0aGVtIGhvcml6b250YWxseS4NCiAgICAgKiBUaGlzIGNsYXNzIGNhbiBiZSByZW1vdmVkIGlmIGVmZmVjdCBpcyBub3QgdXNlZC4NCiAgICAgKiBJZiBvZmZzZXQgKGRpZmZlcmVuY2UgYmV0d2VlbiBpbmRleCBvZiBjdXJyZW50bHkgZGlzcGxheWVkIHNsaWRlIGFuZCBpbmRleCBvZiBzbGlkZSB0aGF0IHdpbGwgYmUgc2hvd24pDQogICAgICogaXMgZ3JlYXRlciB0aGFuIDAsIHNsaWRlcyBhcmUgc2xpZGluZyB0byB0aGUgbGVmdC4gT3RoZXJ3aXNlIChvZmZzZXQgaXMgbG93ZXIgdGhhbiAwKSwgc2xpZGVzIGFyZSBzbGlkaW5nDQogICAgICogdG8gdGhlIGxlZnQuDQogICAgICogV2hlbiBzbGlkZSBjaGFuZ2UgaXMgcmFpc2VkIGF1dG9tYXRpY2FsbHksIHNsaWRlcyBhcmUgYWx3YXlzIHNsaWRpbmcgdG8gcmlnaHQgKG9mZnNldCA9PSAxKS4NCiAgICAgKiBJZiB1c2VyIHJhaXNlcyBzbGlkZXMgY2hhbmdlLCBzbGlkZXMgYXJlIHNsaWRpbmc6DQogICAgICogLSB0byBsZWZ0LCBpZiBvZmZzZXQgaXMgZ3JlYXRlciB0aGFuIDAgKHNsaWRlIHdpdGggaGlnaGVyIGluZGV4IHdpbGwgYmUgc2hvd24gb3IgdXNlciBjbGlja3Mgb24gJ25leHQnIG5hdmlnYXRpb24gaXRlbSksDQogICAgICogLSB0byByaWdodCwgaWYgb2Zmc2V0IGlzIGxvd2VyIHRoYW4gMCAoc2xpZGUgd2l0aCBsb3dlciBpbmRleCB3aWxsIGJlIHNob3duIG9yIHVzZXIgY2xpY2tzIG9uICdwcmV2JyBuYXZpZ2F0aW9uIGl0ZW0pLg0KICAgICAqIEBjb25zdHJ1Y3Rvcg0KICAgICAqLw0KICAgIGZ1bmN0aW9uIFNsaWRlSG9yaXpvbnRhbGx5VHJhbnNpdGlvbigpIHt9DQogICAgU2xpZGVIb3Jpem9udGFsbHlUcmFuc2l0aW9uLnByb3RvdHlwZSA9IG5ldyBUcmFuc2l0aW9uKCk7DQogICAgU2xpZGVIb3Jpem9udGFsbHlUcmFuc2l0aW9uLmNvbnN0cnVjdG9yID0gU2xpZGVIb3Jpem9udGFsbHlUcmFuc2l0aW9uOw0KICAgIC8qKg0KICAgICAqIEBtZW1iZXIgU2xpZGVIb3Jpem9udGFsbHlUcmFuc2l0aW9uDQogICAgICovDQogICAgU2xpZGVIb3Jpem9udGFsbHlUcmFuc2l0aW9uLnByb3RvdHlwZS5vbkFuaW1hdGlvbkNvbXBsZXRlID0gZnVuY3Rpb24oc2V0dGluZ3MsICRwYXJlbnQpIHsNCiAgICAgICAgc2V0dGluZ3MuJGN1cnJlbnRTbGlkZS5oaWRlKCk7DQogICAgICAgIHNldHRpbmdzLiRuZXh0U2xpZGUuY3NzKHsNCiAgICAgICAgICAgICdwb3NpdGlvbic6ICcnLA0KICAgICAgICAgICAgJ3RvcCc6ICcnLA0KICAgICAgICAgICAgJ2xlZnQnOiAnJw0KICAgICAgICB9KTsNCg0KICAgICAgICAkcGFyZW50LmNzcygnbWFyZ2luLWxlZnQnLCAnJyk7DQoNCiAgICAgICAgc2V0dGluZ3MuY2FsbGJhY2soKTsNCiAgICB9Ow0KICAgIC8qKg0KICAgICAqIEBtZW1iZXIgU2xpZGVIb3Jpem9udGFsbHlUcmFuc2l0aW9uDQogICAgICovDQogICAgU2xpZGVIb3Jpem9udGFsbHlUcmFuc2l0aW9uLnByb3RvdHlwZS5wZXJmb3JtID0gZnVuY3Rpb24oc2V0dGluZ3MpIHsNCiAgICAgICAgdmFyIGZhY3RvciA9IHRoaXMuZmFjdG9yKHNldHRpbmdzKSwNCiAgICAgICAgICAgIG9uQW5pbWF0aW9uQ29tcGxldGUgPSB0aGlzLm9uQW5pbWF0aW9uQ29tcGxldGUsDQogICAgICAgICAgICB3aWR0aCA9IHNldHRpbmdzLiRjdXJyZW50U2xpZGUud2lkdGgoKSwNCiAgICAgICAgICAgICRwYXJlbnQgPSBzZXR0aW5ncy4kc2xpZGVzLnBhcmVudCgpOw0KDQogICAgICAgIHNldHRpbmdzLiRuZXh0U2xpZGUuY3NzKHsNCiAgICAgICAgICAgICdwb3NpdGlvbic6ICdhYnNvbHV0ZScsDQogICAgICAgICAgICAndG9wJzogJzBweCcsDQogICAgICAgICAgICAnbGVmdCc6IGZhY3RvciAqIHdpZHRoDQogICAgICAgIH0pOw0KICAgICAgICBzZXR0aW5ncy4kbmV4dFNsaWRlLnNob3coKTsNCg0KICAgICAgICAkcGFyZW50LmFuaW1hdGUoew0KICAgICAgICAgICAgJ21hcmdpbi1sZWZ0JzogLWZhY3RvciAqIHdpZHRoDQogICAgICAgIH0sIGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgb25BbmltYXRpb25Db21wbGV0ZShzZXR0aW5ncywgJHBhcmVudCk7DQogICAgICAgIH0pOw0KICAgIH07DQogICAgLyoqDQogICAgICogRW5kIG9mIFNsaWRlSG9yaXpvbnRhbGx5VHJhbnNpdGlvbiBjbGFzcw0KICAgICAqLw0KICAgIHB1Yi5TbGlkZUhvcml6b250YWxseVRyYW5zaXRpb24gPSBTbGlkZUhvcml6b250YWxseVRyYW5zaXRpb247DQoNCiAgICAvKioNCiAgICAgKiBTbGlkZVZlcnRpY2FsbHlUcmFuc2l0aW9uIGNsYXNzIGNoYW5nZXMgc2xpZGVzIGJ5IHNsaWRpbmcgdGhlbSB2ZXJ0aWNhbGx5Lg0KICAgICAqIFRoaXMgY2xhc3MgY2FuIGJlIHJlbW92ZWQgaWYgdGhpcyBlZmZlY3QgaXMgbm90IHVzZWQuDQogICAgICogSWYgb2Zmc2V0IChkaWZmZXJlbmNlIGJldHdlZW4gaW5kZXggb2YgY3VycmVudGx5IGRpc3BsYXllZCBzbGlkZSBhbmQgaW5kZXggb2Ygc2xpZGUgdGhhdCB3aWxsIGJlIHNob3duKQ0KICAgICAqIGlzIGdyZWF0ZXIgdGhhbiAwLCBzbGlkZXMgYXJlIHNsaWRpbmcgZnJvbSB1cCB0byBkb3duLiBPdGhlcndpc2UgKG9mZnNldCBpcyBsb3dlciB0aGFuIDApLCBzbGlkZXMgYXJlIHNsaWRpbmcNCiAgICAgKiBmcm9tIGRvd24gdG8gdXAuDQogICAgICogV2hlbiBzbGlkZSBjaGFuZ2UgaXMgcmFpc2VkIGF1dG9tYXRpY2FsbHksIHNsaWRlcyBhcmUgYWx3YXlzIHNsaWRpbmcgZnJvbSB1cCB0byBkb3duIChvZmZzZXQgPT0gMSkuDQogICAgICogSWYgdXNlciByYWlzZXMgc2xpZGVzIGNoYW5nZSwgc2xpZGVzIGFyZSBzbGlkaW5nOg0KICAgICAqIC0gZnJvbSB1cCB0byBkb3duLCBpZiBvZmZzZXQgaXMgZ3JlYXRlciB0aGFuIDAgKHNsaWRlIHdpdGggaGlnaGVyIGluZGV4IHdpbGwgYmUgc2hvd24gb3IgdXNlciBjbGlja3Mgb24gJ25leHQnIG5hdmlnYXRpb24gaXRlbSksDQogICAgICogLSBmcm9tIGRvd24gdG8gdXAsIGlmIG9mZnNldCBpcyBsb3dlciB0aGFuIDAgKHNsaWRlIHdpdGggbG93ZXIgaW5kZXggd2lsbCBiZSBzaG93biBvciB1c2VyIGNsaWNrcyBvbiAncHJldicgbmF2aWdhdGlvbiBpdGVtKS4NCiAgICAgKiBAY29uc3RydWN0b3INCiAgICAgKi8NCiAgICBmdW5jdGlvbiBTbGlkZVZlcnRpY2FsbHlUcmFuc2l0aW9uKCkge30NCiAgICBTbGlkZVZlcnRpY2FsbHlUcmFuc2l0aW9uLnByb3RvdHlwZSA9IG5ldyBUcmFuc2l0aW9uKCk7DQogICAgU2xpZGVWZXJ0aWNhbGx5VHJhbnNpdGlvbi5jb25zdHJ1Y3RvciA9IFNsaWRlVmVydGljYWxseVRyYW5zaXRpb247DQogICAgLyoqDQogICAgICogQG1lbWJlciBTbGlkZVZlcnRpY2FsbHlUcmFuc2l0aW9uDQogICAgICovDQogICAgU2xpZGVWZXJ0aWNhbGx5VHJhbnNpdGlvbi5wcm90b3R5cGUub25BbmltYXRpb25Db21wbGV0ZSA9IGZ1bmN0aW9uKHNldHRpbmdzLCAkcGFyZW50KSB7DQogICAgICAgIHNldHRpbmdzLiRjdXJyZW50U2xpZGUuaGlkZSgpOw0KICAgICAgICBzZXR0aW5ncy4kbmV4dFNsaWRlLmNzcyh7DQogICAgICAgICAgICAncG9zaXRpb24nOiAnJywNCiAgICAgICAgICAgICd0b3AnOiAnJywNCiAgICAgICAgICAgICdsZWZ0JzogJycNCiAgICAgICAgfSk7DQoNCiAgICAgICAgJHBhcmVudC5jc3MoJ21hcmdpbi10b3AnLCAnJyk7DQoNCiAgICAgICAgc2V0dGluZ3MuY2FsbGJhY2soKTsNCiAgICB9Ow0KICAgIC8qKg0KICAgICAqIEBtZW1iZXIgU2xpZGVWZXJ0aWNhbGx5VHJhbnNpdGlvbg0KICAgICAqLw0KICAgIFNsaWRlVmVydGljYWxseVRyYW5zaXRpb24ucHJvdG90eXBlLnBlcmZvcm0gPSBmdW5jdGlvbihzZXR0aW5ncykgew0KICAgICAgICB2YXIgZmFjdG9yID0gdGhpcy5mYWN0b3Ioc2V0dGluZ3MpLA0KICAgICAgICAgICAgb25BbmltYXRpb25Db21wbGV0ZSA9IHRoaXMub25BbmltYXRpb25Db21wbGV0ZSwNCiAgICAgICAgICAgIGhlaWdodCA9IHNldHRpbmdzLiRjdXJyZW50U2xpZGUuaGVpZ2h0KCksDQogICAgICAgICAgICAkcGFyZW50ID0gc2V0dGluZ3MuJHNsaWRlcy5wYXJlbnQoKTsNCg0KICAgICAgICBzZXR0aW5ncy4kbmV4dFNsaWRlLmNzcyh7DQogICAgICAgICAgICAncG9zaXRpb24nOiAnYWJzb2x1dGUnLA0KICAgICAgICAgICAgJ3RvcCc6IC1mYWN0b3IgKiBoZWlnaHQsDQogICAgICAgICAgICAnbGVmdCc6ICcwcHgnDQogICAgICAgIH0pOw0KICAgICAgICBzZXR0aW5ncy4kbmV4dFNsaWRlLnNob3coKTsNCg0KICAgICAgICAkcGFyZW50LmFuaW1hdGUoew0KICAgICAgICAgICAgJ21hcmdpbi10b3AnOiBmYWN0b3IgKiBoZWlnaHQNCiAgICAgICAgfSwgZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBvbkFuaW1hdGlvbkNvbXBsZXRlKHNldHRpbmdzLCAkcGFyZW50KTsNCiAgICAgICAgfSk7DQogICAgfTsNCiAgICAvKioNCiAgICAgKiBTbGlkZVZlcnRpY2FsbHlUcmFuc2l0aW9uIGNsYXNzDQogICAgICovDQogICAgcHViLlNsaWRlVmVydGljYWxseVRyYW5zaXRpb24gPSBTbGlkZVZlcnRpY2FsbHlUcmFuc2l0aW9uOw0KDQogICAgcmV0dXJuIHB1YjsNCn0oalF1ZXJ5KSk7DQovKioNCiAqIGVuZCBvZiBYQS5jb21wb25lbnQuY2Fyb3VzZWxzLlRyYW5zaXRpb25zIG1vZHVsZS4NCiAqLw0KDQovKioNCiAqIENvZ25pZmlkZQ0KICoNCiAqIFhBLmNvbXBvbmVudC5jYXJvdXNlbHMuSW5kaWNhdG9yVmlld3MgbW9kdWxlLg0KICoNCiAqIEV4cG9zZXMgVmlldyBjbGFzcywgd2hpY2ggaXMgYSBiYXNlIGNsYXNzIG9mIGFsbCAndGltZSBpbmRpY2F0b3InIHZpZXdzIHVzZWQgYnkgY2Fyb3VzZWxzIChAc2VlIFhBLmNvbXBvbmVudC5jYXJvdXNlbHMsIEBzZWUgVmlldykuDQogKiBBbHNvIGV4cG9zZXMgaW1wbGVtZW50YXRpb24gb2YgdGhlc2UgJ3RpbWUgaW5kaWNhdG9yJyB2aWV3czoNCiAqIC0gUHJvZ3Jlc3NCYXJWaWV3IC0gc2hvd3MgdGhlIHByb2dyZXNzIG9mIHRpbWUsIHRoYXQgbG9va3MgbGlrZSBhIHByb2dyZXNzIGJhciwNCiAqIC0gUm90YXRvclZpZXcgLSBzaG93cyB0aGUgcHJvZ3Jlc3Mgb2YgdGltZSB3aXRoIHRoZSBmaWxsaW5nIHVwIHJpbmcuDQogKiBDYXJvdXNlbCB0YWtlcyB0aGUgY2xhc3MgY29uc3RydWN0b3IgYnkgbmFtZSBmcm9tIHRoaXMgbW9kdWxlIChpdCBpcyBnaXZlbiBpbiBvcHRpb25zIG9iamVjdCBvZiBjYXJvdXNlbDsgQHNlZSBYQS5jb21wb25lbnQuY2Fyb3VzZWxzKS4NCiAqIElmIHRoZXJlIGlzIGEgbmVlZCB0byBpbXBsZW1lbnQgdGhlIG5ldyAndGltZSBpbmRpY2F0b3InIHZpZXcsIGNyZWF0ZSBhIG5ldyBjbGFzcywNCiAqIGJ5IGluaGVyaXRpbmcgZnJvbSBWaWV3IGNsYXNzIGFuZCBhZGQgaXQgdG8gdGhpcyBtb2R1bGUuIER1cmluZyBpbXBsZW1lbnRhdGlvbiBvZiBhIG5ldyAndGltZSBpbmRpY2F0b3InDQogKiB2aWV3IHRoZSBYQS5jb21wb25lbnQuY2Fyb3VzZWxzLkluZGljYXRvcnNWaWV3LlRvb2xzIG5hbWVzcGFjZSBtYXkgYmUgdXNlZnVsbC4gSXQgY29udGFpbnM6DQogKiAtIGlzQ3NzU3VwcG9ydGVkKHByb3BzKSBmdW5jdGlvbiwgd2hpY2ggY2hlY2tzIGlmIGFueSBvZiBDU1MgcHJvcGVydGllcyBpcyBzdXBwb3J0ZWQgKHByb3BzIC0gYXJyYXkgb2YgcHJvcGVydGllcyksDQogKiAtIGlzVHJhbnNmb3JtU3VwcG9ydGVkKCkgZnVuY3Rpb24sIHdoaWNoIGNoZWNrcyBpZiBDU1MgMyAndHJhbnNmb3JtJyBpcyBzdXBwb3J0ZWQuDQogKg0KICogRXhhbXBsZSB2aWV3IGltcGxlbWVudGF0aW9uIChvcGFjaXR5IGluY3JlYXNlcyB3aXRoIGEgcHJvZ3Jlc3Mgb2YgdGhlIHRpbWUpOg0KICogKGZ1bmN0aW9uKCkgew0KICogICAgIHZhciBWaWV3ID0gWEEuY29tcG9uZW50LmNhcm91c2Vscy5JbmRpY2F0b3JWaWV3cy5WaWV3Ow0KICoNCiAqICAgICBmdW5jdGlvbiBTYW1wbGVWaWV3IChzZWxlY3Rvciwgb3B0aW9ucykgew0KICogICAgICAgICAvL2Jhc2UgY29uc3RydWN0b3IgaGF2ZSB0byBiZSBjYWxsZWQNCiAqICAgICAgICAgVmlldy5jYWxsKHRoaXMsIHNlbGVjdG9yKTsNCiAqICAgICB9DQogKg0KICogICAgIFNhbXBsZVZpZXcucHJvdG90eXBlID0gbmV3IFZpZXcoKTsNCiAqICAgICBTYW1wbGVWaWV3LmNvbnN0cnVjdG9yID0gU2FtcGxlVmlldzsNCiAqDQogKiAgICAgU2FtcGxlVmlldy5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICh0aW1lb3V0KSB7DQogKiAgICAgICAgIC8vYmFzZSBtZXRob2QgaGF2ZSB0byBiZSBjYWxsZWQNCiAqICAgICAgICAgVmlldy5wcm90b3R5cGUuaW5pdC5jYWxsKHRoaXMsIHRpbWVvdXQpOw0KICoNCiAqICAgICAgICAgLy9pbml0aWFsaXphdGlvbiBjb2RlIC0gbm90IG5lZWRlZCBpbiB0aGlzIGV4YW1wbGUNCiAqICAgICB9Ow0KICoNCiAqICAgICBTYW1wbGVWaWV3LnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICgpIHsNCiAqICAgICAgICAgLy9iYXNlIG1ldGhvZCBoYXZlIHRvIGJlIGNhbGxlZA0KICogICAgICAgICBWaWV3LnByb3RvdHlwZS5yZXNldC5jYWxsKHRoaXMpOw0KICoNCiAqICAgICAgICAgLy9yZXNldGluZyAndGltZSBpbmRpY2F0b3InIHZpZXcNCiAqICAgICAgICAgdGhpcy4kaW5kaWNhdG9yLnN0b3AodHJ1ZSk7DQogKiAgICAgICAgIHRoaXMuJGluZGljYXRvci5jc3MoJ29wYWNpdHknLCAwKTsNCiAqICAgICB9Ow0KICoNCiAqICAgICBTYW1wbGVWaWV3LnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uICgpIHsNCiAqICAgICAgICAgLy9zdG9waW5nICd0aW1lIGluZGljYXRvcicgdmlldyBhbmltYXRpb24NCiAqICAgICAgICAgdGhpcy4kaW5kaWNhdG9yLnN0b3AodHJ1ZSk7DQogKiAgICAgfTsNCiAqDQogKiAgICAgU2FtcGxlVmlldy5wcm90b3R5cGUucGxheSA9IGZ1bmN0aW9uICgpIHsNCiAqICAgICAgICAgLy9zdGFydGluZy9yZXN1bWluZyAndGltZSBpbmRpY2F0b3InIHZpZXcgYW5pbWF0aW9uDQogKiAgICAgICAgIHRoaXMuJGluZGljYXRvci5hbmltYXRlKHsNCiAqICAgICAgICAgICAgICdvcGFjaXR5JzogMQ0KICogICAgICAgICB9LCB0aGlzLnRpbWVvdXQgLSB0aGlzLnRpbWVFbGFwc2VkLCAnbGluZWFyJyk7DQogKiAgICAgfTsNCiAqDQogKiAgICAgWEEuY29tcG9uZW50LmNhcm91c2Vscy5JbmRpY2F0b3JWaWV3cy5TYW1wbGVWaWV3ID0gU2FtcGxlVmlldzsNCiAqIH0oKSk7DQogKg0KICovDQpYQS5jb21wb25lbnQuY2Fyb3VzZWxzLkluZGljYXRvclZpZXdzID0gKGZ1bmN0aW9uKCQpIHsNCiAgICB2YXIgcHViID0ge30sDQogICAgICAgIHN1cHBvcnRFbGVtZW50U3R5bGUgPSBudWxsOw0KDQogICAgLyoqDQogICAgICogQ2hlY2tzIGlmIGFueSBvZiBDU1MgcHJvcGVydGllcyBpcyBzdXBwb3J0ZWQuDQogICAgICoNCiAgICAgKiBAcGFyYW0ge0FycmF5fSBwcm9wcyAgICAgYXJyYXkgb2YgcHJvcGVydGllcyB0byBiZSBjaGVja2VkDQogICAgICogQHJldHVybiB0cnVlIGlmIGFueSBvZiBDU1MgcHJvcGVydGllcyBpcyBzdXBwb3J0ZWQsIGZhbHNlIG90aGVyd2lzZQ0KICAgICAqIEB0eXBlIEJvb2xlYW4NCiAgICAgKi8NCiAgICBmdW5jdGlvbiBpc0Nzc1N1cHBvcnRlZChwcm9wcykgew0KICAgICAgICB2YXIgaSwNCiAgICAgICAgICAgIGlzU3VwcG9ydGVkID0gZmFsc2U7DQoNCiAgICAgICAgaWYgKHN1cHBvcnRFbGVtZW50U3R5bGUgPT09IG51bGwpIHsNCiAgICAgICAgICAgIHN1cHBvcnRFbGVtZW50U3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdXBwb3J0RWxlbWVudCcpLnN0eWxlOw0KICAgICAgICB9DQoNCiAgICAgICAgZm9yIChpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICBpZiAoc3VwcG9ydEVsZW1lbnRTdHlsZVtwcm9wc1tpXV0gIT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIGlzU3VwcG9ydGVkID0gdHJ1ZTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBpc1N1cHBvcnRlZDsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBDaGVja3MgaWYgQ1NTIDMgJ3RyYW5zZm9ybScgaXMgc3VwcG9ydGVkLg0KICAgICAqDQogICAgICogQHJldHVybiB0cnVlIGlmIENTUyAzICd0cmFuc2Zvcm0nIGlzIHN1cHBvcnRlZCwgZmFsc2Ugb3RoZXJ3aXNlDQogICAgICogQHR5cGUgQm9vbGVhbg0KICAgICAqLw0KICAgIGZ1bmN0aW9uIGlzVHJhbnNmb3JtU3VwcG9ydGVkKCkgew0KICAgICAgICByZXR1cm4gaXNDc3NTdXBwb3J0ZWQoWyd0cmFuc2Zvcm1Qcm9wZXJ0eScsICdXZWJraXRUcmFuc2Zvcm0nLCAnTW96VHJhbnNmb3JtJywgJ09UcmFuc2Zvcm0nLCAnbXNUcmFuc2Zvcm0nXSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogWEEuY29tcG9uZW50LmNhcm91c2Vscy5JbmRpY2F0b3JWaWV3cy5Ub29scyBuYW1lc3BhY2UNCiAgICAgKg0KICAgICBUaGlzIG5hbWVzcGFjZSBjYW4gYmUgcmVtb3ZlZCBpZiBSb3RhdG9yVmlldyBjbGFzcyBpcyBub3QgdXNlZCAoQHNlZSBSb3RhdG9yVmlldykNCiAgICAgKi8NCiAgICBwdWIuVG9vbHMgPSB7fTsNCiAgICBwdWIuVG9vbHMuaXNDc3NTdXBwb3J0ZWQgPSBpc0Nzc1N1cHBvcnRlZDsNCiAgICBwdWIuVG9vbHMuaXNUcmFuc2Zvcm1TdXBwb3J0ZWQgPSBpc1RyYW5zZm9ybVN1cHBvcnRlZDsNCiAgICAvKioNCiAgICAgKiBFbmQgb2YgbmFtZXNwYWNlDQogICAgICovDQoNCiAgICAvKioNCiAgICAgKiBWaWV3IGNsYXNzIGlzIGEgYmFzZSBjbGFzcyBvZiBhbGwgJ3RpbWUgaW5kaWNhdG9yJyB2aWV3cw0KICAgICAqIEBjb25zdHJ1Y3Rvcg0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzZWxlY3RvciBhIHNlbGVjdG9yIHVzZWQgZm9yIHNlYXJjaGluZw0KICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zICAgVmlldyBvcHRpb25zIG9iamVjdA0KICAgICAqLw0KICAgIGZ1bmN0aW9uIFZpZXcoc2VsZWN0b3IsIG9wdGlvbnMpIHsNCiAgICAgICAgLyoqDQogICAgICAgICAqIEEgalF1ZXJ5IG9iamVjdCBjb250YWluaW5nIGVsZW1lbnQsIHdoaWNoIHdpbGwgYmUgYW5pbWF0ZWQgdG8gc2hvdyBwb2dyZXNzIG9mIHRoZSB0aW1lLg0KICAgICAgICAgKg0KICAgICAgICAgKiBAbWVtYmVyIFZpZXcNCiAgICAgICAgICovDQogICAgICAgIHRoaXMuJGluZGljYXRvciA9ICQoc2VsZWN0b3IpOw0KICAgIH0NCiAgICAvKioNCiAgICAgKiBJbml0aWFsaXplcyB0aGUgdmlldy4NCiAgICAgKg0KICAgICAqIEBtZW1iZXIgVmlld2lvbg0KICAgICAqIEBwYXJhbSB7TnVtYmVyfSB0aW1lb3V0ICAgYSB0aW1lb3V0IHRvIHRoZSBlbmQgb2Ygd2hvbGUgaW5kaWNhdG9yIGFuaW1hdGlvbg0KICAgICAqLw0KICAgIFZpZXcucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbih0aW1lb3V0KSB7DQogICAgICAgIHRoaXMudGltZUVsYXBzZWQgPSAwOw0KICAgICAgICB0aGlzLnRpbWVvdXQgPSB0aW1lb3V0Ow0KICAgIH07DQogICAgLyoqDQogICAgICogUmVzZXRzIHRoZSB2aWV3DQogICAgICoNCiAgICAgKiBAbWVtYmVyIFZpZXcNCiAgICAgKi8NCiAgICBWaWV3LnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICB0aGlzLnRpbWVFbGFwc2VkID0gMDsNCiAgICB9Ow0KICAgIC8qKg0KICAgICAqIFN0YXJ0cy9SZW5ld3MgdGhlIHZpZXcgYW5pbWF0aW9uLg0KICAgICAqDQogICAgICogQG1lbWJlciBWaWV3DQogICAgICovDQogICAgVmlldy5wcm90b3R5cGUucGxheSA9IGZ1bmN0aW9uKCkge307DQogICAgLyoqDQogICAgICogUGF1c2VzIHRoZSB2aWV3IGFuaW1hdGlvbi4NCiAgICAgKg0KICAgICAqIEBtZW1iZXIgVmlldw0KICAgICAqLw0KICAgIFZpZXcucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24oKSB7fTsNCiAgICAvKioNCiAgICAgKiBVcGRhdGVzIHRoZSB0aW1lIHRoYXQgZWxhcHNlZCBzaW5jZSBhbmltYXRpb24gYmVnaW4uDQogICAgICoNCiAgICAgKiBAbWVtYmVyIFZpZXcNCiAgICAgKi8NCiAgICBWaWV3LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbih0aW1lRWxhcHNlZCkgew0KICAgICAgICB0aGlzLnRpbWVFbGFwc2VkID0gdGltZUVsYXBzZWQ7DQogICAgfTsNCiAgICAvKioNCiAgICAgKiBlbmQgb2YgVmlldyBjbGFzcw0KICAgICAqLw0KICAgIHB1Yi5WaWV3ID0gVmlldzsNCg0KICAgIC8qKg0KICAgICAqIFByb2dyZXNzQmFyVmlldyBjbGFzcyBwcm92aWRlcyBhIGxvZ2ljIGZvciBhbmltYXRlIGEgJ3RpbWUgaW5kaWNhdG9yJywNCiAgICAgKiB0aGF0IGxvb2tzIGxpa2UgcHJvZ3Jlc3MgYmFyLg0KICAgICAqDQogICAgICogT3B0aW9ucyBvYmplY3Q6DQogICAgICogew0KICAgICAqICAgICAnb3BhY2l0eSc6IE51bWJlciB2YWx1ZSAvL2JldHdlZW4gMCBhbmQgMTsgZGVmYXVsdCBpcyAwLjgNCiAgICAgKiB9DQogICAgICoNCiAgICAgKiBUaGlzIGNsYXNzIGNhbiBiZSByZW1vdmVkIGlmIHRoaXMga2luZCBvZiB2aWV3IGlzIG5vdCB1c2VkLg0KICAgICAqDQogICAgICogQGNvbnN0cnVjdG9yDQogICAgICogQHBhcmFtIHtTdHJpbmd9IHNlbGVjdG9yIGEgc2VsZWN0b3IgdXNlZCBmb3Igc2VhcmNoaW5nDQogICAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgICBWaWV3IG9wdGlvbnMgb2JqZWN0DQogICAgICovDQogICAgZnVuY3Rpb24gUHJvZ3Jlc3NCYXJWaWV3KHNlbGVjdG9yLCBvcHRpb25zKSB7DQogICAgICAgIFZpZXcuY2FsbCh0aGlzLCBzZWxlY3Rvcik7DQoNCiAgICAgICAgdmFyIGRlZmF1bHRzID0gew0KICAgICAgICAgICAgJ29wYWNpdHknOiAwLjgNCiAgICAgICAgfTsNCg0KICAgICAgICB0aGlzLnNldHRpbmdzID0gJC5leHRlbmQodHJ1ZSwge30sIGRlZmF1bHRzLCBvcHRpb25zKTsNCg0KICAgICAgICB0aGlzLiRjb250YWluZXIgPSB0aGlzLiRpbmRpY2F0b3I7DQogICAgICAgIHRoaXMuJGluZGljYXRvciA9IHRoaXMuJGluZGljYXRvci5maW5kKCdkaXYnKTsNCiAgICB9DQogICAgUHJvZ3Jlc3NCYXJWaWV3LnByb3RvdHlwZSA9IG5ldyBWaWV3KCk7DQogICAgUHJvZ3Jlc3NCYXJWaWV3LmNvbnN0cnVjdG9yID0gUHJvZ3Jlc3NCYXJWaWV3Ow0KICAgIC8qKg0KICAgICAqIEBtZW1iZXIgUHJvZ3Jlc3NCYXJWaWV3DQogICAgICovDQogICAgUHJvZ3Jlc3NCYXJWaWV3LnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24odGltZW91dCkgew0KICAgICAgICBWaWV3LnByb3RvdHlwZS5pbml0LmNhbGwodGhpcywgdGltZW91dCk7DQoNCiAgICAgICAgdmFyIG9wYWNpdHkgPSB0aGlzLnNldHRpbmdzLm9wYWNpdHk7DQogICAgICAgIHRoaXMuJGNvbnRhaW5lci5jc3MoJ29wYWNpdHknLCBvcGFjaXR5KTsNCiAgICAgICAgdGhpcy4kaW5kaWNhdG9yLmNzcygnb3BhY2l0eScsIG9wYWNpdHkpOw0KICAgIH07DQogICAgLyoqDQogICAgICogQG1lbWJlciBQcm9ncmVzc0JhclZpZXcNCiAgICAgKi8NCiAgICBQcm9ncmVzc0JhclZpZXcucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKSB7DQogICAgICAgIFZpZXcucHJvdG90eXBlLnJlc2V0LmNhbGwodGhpcyk7DQoNCiAgICAgICAgdGhpcy4kaW5kaWNhdG9yLnN0b3AodHJ1ZSk7DQogICAgICAgIHRoaXMuJGluZGljYXRvci5jc3MoJ3dpZHRoJywgJzBweCcpOw0KICAgIH07DQogICAgLyoqDQogICAgICogQG1lbWJlciBQcm9ncmVzc0JhclZpZXcNCiAgICAgKi8NCiAgICBQcm9ncmVzc0JhclZpZXcucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24oKSB7DQogICAgICAgIHRoaXMuJGluZGljYXRvci5zdG9wKHRydWUpOw0KICAgIH07DQogICAgLyoqDQogICAgICogQG1lbWJlciBQcm9ncmVzc0JhclZpZXcNCiAgICAgKi8NCiAgICBQcm9ncmVzc0JhclZpZXcucHJvdG90eXBlLnBsYXkgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgdGhpcy4kaW5kaWNhdG9yLmFuaW1hdGUoew0KICAgICAgICAgICAgJ3dpZHRoJzogJzEwMCUnDQogICAgICAgIH0sIHRoaXMudGltZW91dCAtIHRoaXMudGltZUVsYXBzZWQsICdsaW5lYXInKTsNCiAgICB9Ow0KICAgIC8qKg0KICAgICAqIGVuZCBvZiBQcm9ncmVzc0JhclZpZXcgY2xhc3MNCiAgICAgKi8NCiAgICBwdWIuUHJvZ3Jlc3NCYXJWaWV3ID0gUHJvZ3Jlc3NCYXJWaWV3Ow0KDQogICAgLyoqDQogICAgICogUm90YXRvclZpZXcgY2xhc3MgcHJvdmlkZXMgYSBsb2dpYyBmb3IgYW5pbWF0ZSBhICd0aW1lIGluZGljYXRvcicsDQogICAgICogdGhhdCBzaG93cyB0aGUgcHJvZ3Jlc3Mgb2YgdGltZSB3aXRoIHRoZSBmaWxsaW5nIHVwIHJpbmcNCiAgICAgKg0KICAgICAqIE9wdGlvbnMgb2JqZWN0Og0KICAgICAqIHsNCiAgICAgKiAgICAgJ29wYWNpdHknOiBOdW1iZXIgdmFsdWUgLy9iZXR3ZWVuIDAgYW5kIDE7IGRlZmF1bHQgaXMgMC41DQogICAgICogfQ0KICAgICAqDQogICAgICogVGhpcyBjbGFzcyBjYW4gYmUgcmVtb3ZlZCBpZiB0aGlzIGtpbmQgb2YgdmlldyBpcyBub3QgdXNlZC4NCiAgICAgKg0KICAgICAqIEBjb25zdHJ1Y3Rvcg0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzZWxlY3RvciBhIHNlbGVjdG9yIHVzZWQgZm9yIHNlYXJjaGluZw0KICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zICAgVmlldyBvcHRpb25zIG9iamVjdA0KICAgICAqLw0KICAgIGZ1bmN0aW9uIFJvdGF0b3JWaWV3KHNlbGVjdG9yLCBvcHRpb25zKSB7DQogICAgICAgIFZpZXcuY2FsbCh0aGlzLCBzZWxlY3Rvcik7DQoNCiAgICAgICAgdmFyIGRlZmF1bHRzID0gew0KICAgICAgICAgICAgJ29wYWNpdHknOiAwLjUNCiAgICAgICAgfTsNCg0KICAgICAgICB0aGlzLnNldHRpbmdzID0gJC5leHRlbmQodHJ1ZSwge30sIGRlZmF1bHRzLCBvcHRpb25zKTsNCiAgICAgICAgdGhpcy4kbWFzayA9IHRoaXMuJGluZGljYXRvci5maW5kKCdzcGFuLm1hc2snKS5maXJzdCgpOw0KICAgICAgICB0aGlzLiRyb3RhdG9yID0gdGhpcy4kaW5kaWNhdG9yLmZpbmQoJ3NwYW4ucm90YXRvcicpLmZpcnN0KCk7DQoNCiAgICAgICAgZnVuY3Rpb24gcm90YXRlQ3NzKGRlZykgew0KICAgICAgICAgICAgdmFyIHZhbHVlID0gJ3JvdGF0ZSgnICsgZGVnICsgJ2RlZyknOw0KDQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgICctd2Via2l0LXRyYW5zZm9ybSc6IHZhbHVlLA0KICAgICAgICAgICAgICAgICctbW96LXRyYW5zZm9ybSc6IHZhbHVlLA0KICAgICAgICAgICAgICAgICctby10cmFuc2Zvcm0nOiB2YWx1ZSwNCiAgICAgICAgICAgICAgICAnLW1zLXRyYW5zZm9ybSc6IHZhbHVlLA0KICAgICAgICAgICAgICAgICd0cmFuc2Zvcm0nOiB2YWx1ZQ0KICAgICAgICAgICAgfTsNCiAgICAgICAgfQ0KDQogICAgICAgIGZ1bmN0aW9uIGFuaW1hdGVSb3RhdG9yKCRyb3RhdG9yLCBvcHRpb25zKSB7DQogICAgICAgICAgICB2YXIgZGVmYXVsdHMgPSB7DQogICAgICAgICAgICAgICAgICAgICdmb250U2l6ZSc6ICcxODBweCcsDQogICAgICAgICAgICAgICAgICAgICdhbmltYXRlT3B0aW9ucyc6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICdzdGVwJzogZnVuY3Rpb24obm93LCBmeCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb3RhdG9yLmNzcyhyb3RhdGVDc3Mobm93KSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgJ2Vhc2luZyc6ICdsaW5lYXInDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHNldHRpbmdzID0gJC5leHRlbmQodHJ1ZSwge30sIGRlZmF1bHRzLCBvcHRpb25zKTsNCg0KICAgICAgICAgICAgJHJvdGF0b3IuYW5pbWF0ZSh7DQogICAgICAgICAgICAgICAgICAgICdmb250LXNpemUnOiBzZXR0aW5ncy5mb250U2l6ZQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgc2V0dGluZ3MuYW5pbWF0ZU9wdGlvbnMpOw0KICAgICAgICB9DQoNCiAgICAgICAgZnVuY3Rpb24gcGhhc2VUd29BbmltYXRpb24oJG1hc2ssICRyb3RhdG9yLCBkdXJhdGlvbikgew0KICAgICAgICAgICAgJHJvdGF0b3IuYWRkQ2xhc3MoJ2hhbGYnKTsNCiAgICAgICAgICAgICRtYXNrLmFkZENsYXNzKCdoYWxmJyk7DQoNCiAgICAgICAgICAgIGFuaW1hdGVSb3RhdG9yKCRyb3RhdG9yLCB7DQogICAgICAgICAgICAgICAgJ2ZvbnRTaXplJzogJzM2MHB4JywNCiAgICAgICAgICAgICAgICAnYW5pbWF0ZU9wdGlvbnMnOiB7DQogICAgICAgICAgICAgICAgICAgICdkdXJhdGlvbic6IGR1cmF0aW9uDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCg0KICAgICAgICBmdW5jdGlvbiBwaGFzZU9uZUFuaW1hdGlvbigkbWFzaywgJHJvdGF0b3IsIGR1cmF0aW9uLCBwaGFzZVR3b0R1cmF0aW9uKSB7DQogICAgICAgICAgICBhbmltYXRlUm90YXRvcigkcm90YXRvciwgew0KICAgICAgICAgICAgICAgICdhbmltYXRlT3B0aW9ucyc6IHsNCiAgICAgICAgICAgICAgICAgICAgJ2R1cmF0aW9uJzogZHVyYXRpb24sDQogICAgICAgICAgICAgICAgICAgICdjb21wbGV0ZSc6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcGhhc2VUd29BbmltYXRpb24oJG1hc2ssICRyb3RhdG9yLCBwaGFzZVR3b0R1cmF0aW9uKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQoNCiAgICAgICAgdGhpcy5yZXNldENzcyA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdGhpcy4kcm90YXRvci5yZW1vdmVDbGFzcygnaGFsZicpOw0KICAgICAgICAgICAgdGhpcy4kcm90YXRvci5jc3Mocm90YXRlQ3NzKDApKTsNCiAgICAgICAgICAgIHRoaXMuJHJvdGF0b3IuY3NzKCdmb250LXNpemUnLCAnMHB4Jyk7DQoNCiAgICAgICAgICAgIHRoaXMuJG1hc2sucmVtb3ZlQ2xhc3MoJ2hhbGYnKTsNCiAgICAgICAgfTsNCg0KICAgICAgICB0aGlzLnBsYXlQaGFzZU9uZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIGR1cmF0aW9uID0gdGhpcy50aW1lb3V0IC8gMiAtIHRoaXMudGltZUVsYXBzZWQ7DQogICAgICAgICAgICBwaGFzZU9uZUFuaW1hdGlvbih0aGlzLiRtYXNrLCB0aGlzLiRyb3RhdG9yLCBkdXJhdGlvbiwgdGhpcy50aW1lb3V0IC8gMik7DQogICAgICAgIH07DQoNCiAgICAgICAgdGhpcy5wbGF5UGhhc2VUd28gPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBkdXJhdGlvbiA9IHRoaXMudGltZW91dCAtIHRoaXMudGltZUVsYXBzZWQ7DQogICAgICAgICAgICBwaGFzZVR3b0FuaW1hdGlvbih0aGlzLiRtYXNrLCB0aGlzLiRyb3RhdG9yLCBkdXJhdGlvbik7DQogICAgICAgIH07DQogICAgfQ0KICAgIFJvdGF0b3JWaWV3LnByb3RvdHlwZSA9IG5ldyBWaWV3KCk7DQogICAgUm90YXRvclZpZXcuY29uc3RydWN0b3IgPSBSb3RhdG9yVmlldzsNCiAgICAvKioNCiAgICAgKiBAbWVtYmVyIFJvdGF0b3JWaWV3DQogICAgICovDQogICAgUm90YXRvclZpZXcucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbih0aW1lb3V0KSB7DQogICAgICAgIFZpZXcucHJvdG90eXBlLmluaXQuY2FsbCh0aGlzLCB0aW1lb3V0KTsNCg0KICAgICAgICBpZiAoaXNUcmFuc2Zvcm1TdXBwb3J0ZWQoKSkgew0KICAgICAgICAgICAgdGhpcy4kaW5kaWNhdG9yLnNob3coKTsNCiAgICAgICAgICAgIHRoaXMuJG1hc2suY3NzKCdvcGFjaXR5JywgdGhpcy5zZXR0aW5ncy5vcGFjaXR5KTsNCiAgICAgICAgfQ0KICAgIH07DQogICAgLyoqDQogICAgICogQG1lbWJlciBSb3RhdG9yVmlldw0KICAgICAqLw0KICAgIFJvdGF0b3JWaWV3LnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICBWaWV3LnByb3RvdHlwZS5yZXNldC5jYWxsKHRoaXMpOw0KDQogICAgICAgIHRoaXMuJHJvdGF0b3Iuc3RvcCh0cnVlKTsNCiAgICAgICAgdGhpcy5yZXNldENzcygpOw0KICAgIH07DQogICAgLyoqDQogICAgICogQG1lbWJlciBSb3RhdG9yVmlldw0KICAgICAqLw0KICAgIFJvdGF0b3JWaWV3LnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uKCkgew0KICAgICAgICB0aGlzLiRyb3RhdG9yLnN0b3AodHJ1ZSk7DQogICAgfTsNCiAgICAvKioNCiAgICAgKiBAbWVtYmVyIFJvdGF0b3JWaWV3DQogICAgICovDQogICAgUm90YXRvclZpZXcucHJvdG90eXBlLnBsYXkgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgdmFyIHBoYXNlID0gdGhpcy5wbGF5UGhhc2VPbmU7DQogICAgICAgIGlmICh0aGlzLnRpbWVFbGFwc2VkID49IHRoaXMudGltZW91dCAvIDIpIHsNCiAgICAgICAgICAgIHBoYXNlID0gdGhpcy5wbGF5UGhhc2VUd287DQogICAgICAgIH0NCg0KICAgICAgICBwaGFzZS5jYWxsKHRoaXMpOw0KICAgIH07DQogICAgLyoqDQogICAgICogZW5kIG9mIFJvdGF0b3JWaWV3IGNsYXNzDQogICAgICovDQogICAgcHViLlJvdGF0b3JWaWV3ID0gUm90YXRvclZpZXc7DQoNCiAgICByZXR1cm4gcHViOw0KfShqUXVlcnkpKTsNCi8qKg0KICogZW5kIG9mIFhBLmNvbXBvbmVudC5jYXJvdXNlbHMuSW5kaWNhdG9yVmlld3MgbW9kdWxlLg0KICov
- ID: "6954b7c7-2487-423f-8600-436cb3b6dc0e"
  Hint: Size
  Value: 67941
- ID: "6f47a0a5-9c94-4b48-abeb-42d38def6054"
  Hint: Mime Type
  Value: "application/x-javascript"
- ID: "c06867fe-9a43-4c7d-b739-48780492d06f"
  Hint: Extension
  Value: js
Languages:
- Language: en
  Versions:
  - Version: 1
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20170331T161343Z
    - ID: "5dd74568-4d4b-44c1-b513-0af5f4cda34f"
      Hint: __Created by
      Value: |
        sitecore\Admin
